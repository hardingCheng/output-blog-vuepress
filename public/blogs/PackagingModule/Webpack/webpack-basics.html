<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack 基础 | 前端学习总结和技巧</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css">
    <meta name="description" content="一个前端的学习小白，站在前端大佬们的肩膀上前行">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="keywords" content="前端,前端教程,免费前端学习,前端面经,前端知识点,前端知识体系">
    <meta name="decription" content="自我总结前端总结,最全的前端知识点,坚持的刷题路线,完善的学习经验和体系">
    <meta name="robots" content="all">
    <meta name="author" content="hardingcheng">
    
    <link rel="preload" href="/assets/css/0.styles.ae78a777.css" as="style"><link rel="preload" href="/assets/js/app.6b8d69f7.js" as="script"><link rel="preload" href="/assets/js/3.cb90e6dd.js" as="script"><link rel="preload" href="/assets/js/1.e749a552.js" as="script"><link rel="preload" href="/assets/js/32.30328f1c.js" as="script"><link rel="preload" href="/assets/js/9.912710f6.js" as="script"><link rel="prefetch" href="/assets/js/10.f019507e.js"><link rel="prefetch" href="/assets/js/11.7d91c4cf.js"><link rel="prefetch" href="/assets/js/12.29ecceda.js"><link rel="prefetch" href="/assets/js/13.b8acfb06.js"><link rel="prefetch" href="/assets/js/14.25941f80.js"><link rel="prefetch" href="/assets/js/15.9fa984b2.js"><link rel="prefetch" href="/assets/js/16.3beb47ed.js"><link rel="prefetch" href="/assets/js/17.53ce4261.js"><link rel="prefetch" href="/assets/js/18.b540f1c9.js"><link rel="prefetch" href="/assets/js/19.ca2689a8.js"><link rel="prefetch" href="/assets/js/20.43e5ed0f.js"><link rel="prefetch" href="/assets/js/21.fb00f199.js"><link rel="prefetch" href="/assets/js/22.242d0e56.js"><link rel="prefetch" href="/assets/js/23.7803a07e.js"><link rel="prefetch" href="/assets/js/24.eeeae3bc.js"><link rel="prefetch" href="/assets/js/25.4bd2886e.js"><link rel="prefetch" href="/assets/js/26.191fb9df.js"><link rel="prefetch" href="/assets/js/27.ef135e53.js"><link rel="prefetch" href="/assets/js/28.ffa759d1.js"><link rel="prefetch" href="/assets/js/29.f41f2895.js"><link rel="prefetch" href="/assets/js/30.9a7799fb.js"><link rel="prefetch" href="/assets/js/31.cf751455.js"><link rel="prefetch" href="/assets/js/33.0c1e3791.js"><link rel="prefetch" href="/assets/js/34.bab90840.js"><link rel="prefetch" href="/assets/js/35.17b21bad.js"><link rel="prefetch" href="/assets/js/36.f5324114.js"><link rel="prefetch" href="/assets/js/37.a880f1ef.js"><link rel="prefetch" href="/assets/js/38.c5f97983.js"><link rel="prefetch" href="/assets/js/39.ad70967a.js"><link rel="prefetch" href="/assets/js/4.db65a195.js"><link rel="prefetch" href="/assets/js/40.ce385432.js"><link rel="prefetch" href="/assets/js/41.39d5392f.js"><link rel="prefetch" href="/assets/js/42.4104c5ba.js"><link rel="prefetch" href="/assets/js/43.7026a6f0.js"><link rel="prefetch" href="/assets/js/44.44864a5e.js"><link rel="prefetch" href="/assets/js/45.cd8c69d5.js"><link rel="prefetch" href="/assets/js/46.cfca38b9.js"><link rel="prefetch" href="/assets/js/47.ec12cccb.js"><link rel="prefetch" href="/assets/js/48.c5f574eb.js"><link rel="prefetch" href="/assets/js/49.6e28f3cf.js"><link rel="prefetch" href="/assets/js/5.205cc2e2.js"><link rel="prefetch" href="/assets/js/50.249ea85e.js"><link rel="prefetch" href="/assets/js/6.a85ed7ae.js"><link rel="prefetch" href="/assets/js/7.3163c07b.js"><link rel="prefetch" href="/assets/js/8.5fb0cf18.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ae78a777.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1aefc0b4><div data-v-1aefc0b4><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1aefc0b4 data-v-1aefc0b4><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>前端学习总结和技巧</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>一个前端的学习小白，站在前端大佬们的肩膀上前行</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>hardingcheng</span>
            
          <span data-v-25ba6db2>2020-2021 - </span>
          2022
        </a></span></div></div> <div class="hide" data-v-1aefc0b4><header class="navbar" data-v-1aefc0b4><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="前端学习总结和技巧" class="logo"> <span class="site-name">前端学习总结和技巧</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/设计模式/" class="nav-link"><i class="undefined"></i>
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/categories/数据结构/" class="nav-link"><i class="undefined"></i>
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/categories/HTMLCSS/" class="nav-link"><i class="undefined"></i>
  HTMLCSS
</a></li><li class="dropdown-item"><!----> <a href="/categories/JavaScript 面试/" class="nav-link"><i class="undefined"></i>
  JavaScript 面试
</a></li><li class="dropdown-item"><!----> <a href="/categories/手撕代码/" class="nav-link"><i class="undefined"></i>
  手撕代码
</a></li><li class="dropdown-item"><!----> <a href="/categories/HTTP/" class="nav-link"><i class="undefined"></i>
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/categories/VueRouter/" class="nav-link"><i class="undefined"></i>
  VueRouter
</a></li><li class="dropdown-item"><!----> <a href="/categories/Vue/" class="nav-link"><i class="undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/Vuex/" class="nav-link"><i class="undefined"></i>
  Vuex
</a></li><li class="dropdown-item"><!----> <a href="/categories/JavaScript/" class="nav-link"><i class="undefined"></i>
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/categories/Node/" class="nav-link"><i class="undefined"></i>
  Node
</a></li><li class="dropdown-item"><!----> <a href="/categories/Gulp/" class="nav-link"><i class="undefined"></i>
  Gulp
</a></li><li class="dropdown-item"><!----> <a href="/categories/Vite/" class="nav-link"><i class="undefined"></i>
  Vite
</a></li><li class="dropdown-item"><!----> <a href="/categories/Rollup/" class="nav-link"><i class="undefined"></i>
  Rollup
</a></li><li class="dropdown-item"><!----> <a href="/categories/React/" class="nav-link"><i class="undefined"></i>
  React
</a></li><li class="dropdown-item"><!----> <a href="/categories/源码/" class="nav-link"><i class="undefined"></i>
  源码
</a></li><li class="dropdown-item"><!----> <a href="/categories/Webpack/" class="nav-link"><i class="undefined"></i>
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/categories/项目/" class="nav-link"><i class="undefined"></i>
  项目
</a></li><li class="dropdown-item"><!----> <a href="/categories/TypeScript/" class="nav-link"><i class="undefined"></i>
  TypeScript
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      博文
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/daily-blog/" class="nav-link"><i class="undefined"></i>
  日常博文
</a></li><li class="dropdown-item"><!----> <a href="/docs/personal-life/" class="nav-link"><i class="undefined"></i>
  个人生活
</a></li></ul></div></div><div class="nav-item"><a href="/docs/tool-resources/" class="nav-link"><i class="iconfont reco-category"></i>
  资源
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/hardingcheng" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1aefc0b4></div> <aside class="sidebar" data-v-1aefc0b4><div class="personal-info-wrapper" data-v-39576ba9 data-v-1aefc0b4><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-39576ba9> <h3 class="name" data-v-39576ba9>
    hardingcheng
  </h3> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>37</h3> <h6 data-v-39576ba9>Articles</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>21</h3> <h6 data-v-39576ba9>Tags</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/设计模式/" class="nav-link"><i class="undefined"></i>
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/categories/数据结构/" class="nav-link"><i class="undefined"></i>
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/categories/HTMLCSS/" class="nav-link"><i class="undefined"></i>
  HTMLCSS
</a></li><li class="dropdown-item"><!----> <a href="/categories/JavaScript 面试/" class="nav-link"><i class="undefined"></i>
  JavaScript 面试
</a></li><li class="dropdown-item"><!----> <a href="/categories/手撕代码/" class="nav-link"><i class="undefined"></i>
  手撕代码
</a></li><li class="dropdown-item"><!----> <a href="/categories/HTTP/" class="nav-link"><i class="undefined"></i>
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/categories/VueRouter/" class="nav-link"><i class="undefined"></i>
  VueRouter
</a></li><li class="dropdown-item"><!----> <a href="/categories/Vue/" class="nav-link"><i class="undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/Vuex/" class="nav-link"><i class="undefined"></i>
  Vuex
</a></li><li class="dropdown-item"><!----> <a href="/categories/JavaScript/" class="nav-link"><i class="undefined"></i>
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/categories/Node/" class="nav-link"><i class="undefined"></i>
  Node
</a></li><li class="dropdown-item"><!----> <a href="/categories/Gulp/" class="nav-link"><i class="undefined"></i>
  Gulp
</a></li><li class="dropdown-item"><!----> <a href="/categories/Vite/" class="nav-link"><i class="undefined"></i>
  Vite
</a></li><li class="dropdown-item"><!----> <a href="/categories/Rollup/" class="nav-link"><i class="undefined"></i>
  Rollup
</a></li><li class="dropdown-item"><!----> <a href="/categories/React/" class="nav-link"><i class="undefined"></i>
  React
</a></li><li class="dropdown-item"><!----> <a href="/categories/源码/" class="nav-link"><i class="undefined"></i>
  源码
</a></li><li class="dropdown-item"><!----> <a href="/categories/Webpack/" class="nav-link"><i class="undefined"></i>
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/categories/项目/" class="nav-link"><i class="undefined"></i>
  项目
</a></li><li class="dropdown-item"><!----> <a href="/categories/TypeScript/" class="nav-link"><i class="undefined"></i>
  TypeScript
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      博文
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/daily-blog/" class="nav-link"><i class="undefined"></i>
  日常博文
</a></li><li class="dropdown-item"><!----> <a href="/docs/personal-life/" class="nav-link"><i class="undefined"></i>
  个人生活
</a></li></ul></div></div><div class="nav-item"><a href="/docs/tool-resources/" class="nav-link"><i class="iconfont reco-category"></i>
  资源
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/hardingcheng" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>Webpack 基础</h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>hardingcheng</span>
            
          <span data-v-25ba6db2>2020-2021 - </span>
          2022
        </a></span></div></div> <div data-v-1aefc0b4><main class="page"><section><div class="page-title"><h1 class="title">Webpack 基础</h1> <div data-v-f875f3fc><i class="iconfont reco-account" data-v-f875f3fc><span data-v-f875f3fc>hardingcheng</span></i> <i class="iconfont reco-date" data-v-f875f3fc><span data-v-f875f3fc>12/20/2021</span></i> <i class="iconfont reco-eye" data-v-f875f3fc><span id="/blogs/PackagingModule/Webpack/webpack-basics.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-f875f3fc><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-f875f3fc><span class="tag-item" data-v-f875f3fc>Webpack</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="全局需要的函数"><a href="#全局需要的函数" class="header-anchor">#</a> 全局需要的函数</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// node中的api</span>
<span class="token keyword">const</span> appDir <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">resolveApp</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">relativePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>appDir<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>appDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> resolveApp<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="webpack初见"><a href="#webpack初见" class="header-anchor">#</a> webpack初见</h2> <h3 id="vue-cli-service-运行过程"><a href="#vue-cli-service-运行过程" class="header-anchor">#</a> vue-cli-service 运行过程</h3> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210916134828.png" alt=""></p> <h3 id="前端开发的复杂化"><a href="#前端开发的复杂化" class="header-anchor">#</a> 前端开发的复杂化</h3> <p>前端开发目前我们面临哪些复杂的问题呢？
ロ比如开发过程中我们需要通过<strong>模块化的方式</strong>来开发；
ロ比如也会使用一些<strong>高级的特性</strong>来加快我们的<strong>开发效率或者安全性</strong>，比如通过 ES6+、Typescript：开发脚本逻辑，通过** sass、less <strong>等方式来编写 css 样式代码；
ロ比如开发过程中，我们还希望试试的监听文件的变化来并且</strong>反映到浏览器<strong>上，提高开发的效率
ロ比如开发完成后我们还需要将代码进行</strong>压缩、合并以及其他相关的优化**</p> <h3 id="前端是三大框架脚手架"><a href="#前端是三大框架脚手架" class="header-anchor">#</a> 前端是三大框架脚手架</h3> <p>目前前端流行的三大框架：Vue、React、Angular
口但是事实上，这三大框架的创建过程我们都是借助于脚手架（C）的；
口事实上 vue-cli、create-react-app、angular-cli 都是基于 webpack 来帮助我们支持模块化、sass、TypeScript、打包优化等的.
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210916105653.png" alt=""></p> <h3 id="webpack是什么"><a href="#webpack是什么" class="header-anchor">#</a> Webpack是什么？</h3> <p>Webpack 是一个静态的模块化打包工具，为现代的 JavaScript 应用程序我们来对上面的解释进行拆解：
口打包bundler: webpack 可以将帮助我们进行打包，所以它是一个打包工具。
口静态的static：这样表述的原因是我们最终可以将代码打包成最终的静态资源（部署到静态服务器）
口模块化module: webpack 默认支持各种模块化开发，ES Module、CommonJS、AMD 等。
口现代的modern：我们前端说过，正是因为现代前端开发面临各种各样的问题，才催生了Webpack的出现和发展；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210916110723.png" alt=""></p> <h3 id="webpack安装"><a href="#webpack安装" class="header-anchor">#</a> Webpack安装</h3> <p>webpack 的安装目前分为两个：<strong>webpack</strong>、<strong>webpack-cli</strong>
那么它们是什么关系呢？
口执行 webpack 命令，会执行 node_ modules 下的 bin 目录下的 webpack<br>
口webpack 在执行时是依赖 webpack-cli 的，如果没有安装就会报错
口而webpack-cli 中代码执行时，才是真正利用 webpack 进行编译和打包的过程；
口所以在安装 webpack 时，我们需要同时安装 webpack-ci（第三方的脚手架事实上是没有使用 webpack-cli 的，而是类似于自己的 vue-service-cli 的东西）
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210916153607.png" alt=""></p> <h2 id="webpack配置"><a href="#webpack配置" class="header-anchor">#</a> webpack配置</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> resolveApp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./paths&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> VueLoaderPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;vue-loader/lib/plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;terser-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 合并配置文件</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-merge&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.prod&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.dev&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    main<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">&quot;./src/main.js&quot;</span><span class="token punctuation">,</span> dependOn<span class="token operator">:</span> <span class="token string">&quot;shared&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    index<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span> dependOn<span class="token operator">:</span> <span class="token string">&quot;shared&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    lodash<span class="token operator">:</span> <span class="token string">&quot;lodash&quot;</span><span class="token punctuation">,</span>
    dayjs<span class="token operator">:</span> <span class="token string">&quot;dayjs&quot;</span><span class="token punctuation">,</span>
    shared<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;lodash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dayjs&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token function">resolveApp</span><span class="token punctuation">(</span><span class="token string">&quot;./build&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">&quot;[name].bundle.js&quot;</span><span class="token punctuation">,</span>
    chunkFilename<span class="token operator">:</span> <span class="token string">&quot;chunk_[id]_[name].js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.wasm&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.mjs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.jsx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.ts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.vue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;@&quot;</span><span class="token operator">:</span> <span class="token function">resolveApp</span><span class="token punctuation">(</span><span class="token string">&quot;./src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      pages<span class="token operator">:</span> <span class="token function">resolveApp</span><span class="token punctuation">(</span><span class="token string">&quot;./src/pages&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对代码进行压缩相关的操作</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        extractComments<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// natural: 使用自然数(不推荐),</span>
    <span class="token comment">// named: 使用包所在目录作为name(在开发环境推荐)</span>
    <span class="token comment">// deterministic: 生成id, 针对相同文件生成的id是不变</span>
    <span class="token comment">// chunkIds: &quot;deterministic&quot;,</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// async异步导入</span>
      <span class="token comment">// initial同步导入</span>
      <span class="token comment">// all 异步/同步导入</span>
      chunks<span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// 最小尺寸: 如果拆分出来一个, 那么拆分出来的这个包的大小最小为minSize</span>
      minSize<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
      <span class="token comment">// 将大于maxSize的包, 拆分成不小于minSize的包</span>
      maxSize<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
      <span class="token comment">// minChunks表示引入的包, 至少被导入了几次</span>
      minChunks<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
        vendor<span class="token operator">:</span> <span class="token punctuation">{</span>
          test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          filename<span class="token operator">:</span> <span class="token string">&quot;[id]_vendors.js&quot;</span><span class="token punctuation">,</span>
          <span class="token comment">// name: &quot;vendor-chunks.js&quot;,</span>
          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// bar: {</span>
        <span class="token comment">//   test: /bar_/,</span>
        <span class="token comment">//   filename: &quot;[id]_bar.js&quot;</span>
        <span class="token comment">// }</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          filename<span class="token operator">:</span> <span class="token string">&quot;common_[id].js&quot;</span><span class="token punctuation">,</span>
          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// true/multiple</span>
    <span class="token comment">// single</span>
    <span class="token comment">// object: name</span>
    runtimeChunk<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">name</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">entrypoint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">why-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>entrypoint<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">&quot;vue-loader&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token operator">:</span> <span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> isProduction <span class="token operator">=</span> env<span class="token punctuation">.</span>production<span class="token punctuation">;</span>
  process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">=</span> isProduction <span class="token operator">?</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> config <span class="token operator">=</span> isProduction <span class="token operator">?</span> prodConfig <span class="token operator">:</span> devConfig<span class="token punctuation">;</span>
  <span class="token keyword">const</span> mergeConfig <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> mergeConfig<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br></div></div><h3 id="webpack文件配置"><a href="#webpack文件配置" class="header-anchor">#</a> webpack文件配置</h3> <ul><li>在通常情况下，webpack需要打包的项目是非常复杂的，并且我们需要一系列的配置来满足要求，默认配置必然是不可以的。</li> <li>我们可以在根目录下创建一个webpack.config.js文件，来作为webpack的配置文件</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

<span class="token comment">//导出配置信息</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//入口文件</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/main.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        <span class="token comment">//必须是一个绝对路径</span>
        path<span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>继续执行webpack命令，依然可以正常打包</li></ul> <h4 id="指定配置文件"><a href="#指定配置文件" class="header-anchor">#</a> 指定配置文件</h4> <ul><li>但是如果我们的配置文件并不是webpack.config.js的名字，而是其他的名字呢？
<ul><li>比如我们将webpack.config.js修改成了 wk.config.js；</li> <li>这个时候我们可以通过 --config 来指定对应的配置文件；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>webpack <span class="token operator">--</span>config wk<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="webpack依赖图-其实就是流程"><a href="#webpack依赖图-其实就是流程" class="header-anchor">#</a> webpack依赖图（其实就是流程）</h3> <ul><li>webpack到底是如何对我们的项目进行打包的呢？
<ul><li>事实上webpack在处理应用程序时，它会根据命令或者配置文件找到入口文件；</li> <li>从入口开始，会生成一个  依赖关系图，这个依赖关系图会包含应用程序中所需的所有模块（比如.js文件、css文件、图片、 字体等）；</li> <li>然后遍历图结构，打包一个个模块（根据文件的不同使用不同的loader来解析）；</li></ul></li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210916110723.png" alt=""></p> <h3 id="loader"><a href="#loader" class="header-anchor">#</a> Loader</h3> <h4 id="css-loader"><a href="#css-loader" class="header-anchor">#</a> css-loader</h4> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210917120637.png" alt=""></p> <ul><li>需要一个loader来加载这个css文件，但是loader是什么呢？
<ul><li>loader 可以用于对模块的源代码进行转换；</li> <li>我们可以将css文件也看成是一个模块，我们是通过import来加载这个模块的；</li> <li>在加载这个模块时，webpack其实并不知道如何对其进行加载，我们必须制定对应的loader来完成这个功能；</li> <li>对于加载css文件来说，我们需要一个可以读取css文件的loader；</li> <li>这个loader最常用的是css-loader；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install css<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>如何使用这个loader来加载css文件呢？有三种方式：
<ul><li>内联方式
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210917121352.png" alt=""></li> <li>CLI方式（webpack5中不再使用）；
<ul><li>在webpack5的文档中已经没有了<code>--module-bind</code>；</li> <li>实际应用中也比较少使用，因为不方便管理；</li></ul></li> <li>配置方式</li></ul></li></ul> <h4 id="loader配置方式"><a href="#loader配置方式" class="header-anchor">#</a> loader配置方式</h4> <ul><li><p>配置方式表示的意思是在我们的webpack.config.js文件中写明配置信息：</p> <ul><li>module.rules中允许我们配置多个loader（因为我们也会继续使用其他的loader，来完成其他文件的加载）；</li> <li>这种方式可以更好的表示loader的配置，也方便后期的维护，同时也让你对各个Loader有一个全局的概览；</li></ul></li> <li><p>module.rules的配置如下：</p> <ul><li>rules属性对应的值是一个数组：[Rule]</li> <li>数组中存放的是一个个的Rule，Rule是一个对象，对象中可以设置多个属性：
<ul><li><strong>test属性</strong>：用于对 resource（资源）进行匹配的，通常会设置成正则表达式；</li> <li><strong>use属性</strong>：对应的值时一个数组：[UseEntry]
<ul><li>UseEntry是一个对象，可以通过对象的属性来设置一些其他属性
<ul><li>loader：必须有一个 loader属性，对应的值是一个字符串；</li> <li>options：可选的属性，值是一个字符串或者对象，值会被传入到loader中；</li> <li>query：目前已经使用options来替代；</li></ul></li> <li>传递字符串（如：use: [ 'style-loader' ]）是 loader 属性的简写方式（如：use: [ { loader: 'style-loader'} ]）；</li></ul></li> <li><strong>loader属性</strong>： Rule.use: [ { loader } ] 的简写。</li></ul></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

<span class="token comment">//导出配置信息</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//入口文件</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/main.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./build'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">//loader配置</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token comment">// loader:'css-loader',</span>
                <span class="token comment">// use: ['css-loader'],</span>
                <span class="token comment">// 写法三</span>
                use<span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        loader<span class="token operator">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h4 id="style-loader"><a href="#style-loader" class="header-anchor">#</a> style-loader</h4> <ul><li>我们已经可以通过css-loader来加载css文件了
<ul><li>但是你会发现这个css在我们的<strong>代码中并没有生效（页面没有效果）。</strong></li> <li>因为css-loader只是<strong>负责将.css文件进行解析</strong>，并<strong>不会将解析之后的css插入到页面中；</strong></li> <li>如果我们希望再完成<strong>插入style的操作</strong>，那么我们还需要另外一个loader，就是<strong>style-loader</strong>；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install style<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>那么我们应该如何使用style-loader：
<ul><li>在配置文件中，添加style-loader；</li> <li>注意：因为loader的执行顺序是<strong>从右向左（或者说从下到上，或者说从后到前的）</strong>，所以我们需要将<strong>style-loader写到css-loader</strong>的前面；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210917141623.png" alt=""></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token comment">//导出配置信息</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//入口文件</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/main.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./build'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//loader配置</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token comment">// loader:'css-loader',</span>
                <span class="token comment">// use: ['css-loader'],</span>
                <span class="token comment">// 写法三</span>
                use<span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span> loader<span class="token operator">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> loader<span class="token operator">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="postcss"><a href="#postcss" class="header-anchor">#</a> PostCSS</h4> <ul><li>什么是PostCSS呢？
<ul><li>PostCSS是一个通过JavaScript来转换样式的工具；</li> <li>这个工具可以帮助我们进行一些CSS的转换和适配，比如自动添加浏览器前缀、css样式的重置；</li> <li>但是实现这些工具，我们需要借助于PostCSS对应的插件；</li></ul></li> <li>如何使用PostCSS呢？主要就是两个步骤：
<ul><li>第一步：查找PostCSS在构建工具中的扩展，比如webpack中的postcss-loader；</li> <li>第二步：选择可以添加你需要的PostCSS相关的插件；</li></ul></li> <li>在webpack中使用postcss就是使用postcss-loader来处理的；
<ul><li><code>npm install postcss-loader -D</code></li> <li>因为postcss需要有对应的插件才会起效果，所以我们需要配置它的plugin；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
        <span class="token comment">// 规则使用正则表达式</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 匹配资源</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// { loader: &quot;css-loader&quot; },</span>
          <span class="token comment">// 注意: 编写顺序(从下往上, 从右往做, 从后往前)</span>
          <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              importLoaders<span class="token operator">:</span> <span class="token number">1</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">&quot;postcss-loader&quot;</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              postcssOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
                plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
                  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">// loader: &quot;css-loader&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li>单独的postcss配置文件
<ul><li>将这些配置信息放到一个单独的文件中进行管理：
<ul><li>根目录下创建postcss.config.js</li></ul></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// postcss.config.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="postcss-preset-env"><a href="#postcss-preset-env" class="header-anchor">#</a> postcss-preset-env</h5> <ul><li>事实上，在配置postcss-loader时，我们配置插件并不需要使用autoprefixer。</li> <li>我们可以使用另外一个插件：postcss-preset-env
<ul><li>postcss-preset-env也是一个postcss的插件；</li> <li>它可以帮助我们将一些现代的CSS特性，转成大多数浏览器认识的CSS，并且会根据目标浏览器或者运行时环 境添加所需的polyfill；</li> <li>也包括会自动帮助我们添加autoprefixer（所以相当于已经内置了autoprefixer）；</li></ul></li> <li><code>npm install postcss-preset-env -D</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token punctuation">{</span>
   loader<span class="token operator">:</span> <span class="token string">&quot;postcss-loader&quot;</span><span class="token punctuation">,</span>
   options<span class="token operator">:</span> <span class="token punctuation">{</span>
     postcssOptions<span class="token operator">:</span><span class="token punctuation">{</span>
     plugins<span class="token operator">:</span><span class="token punctuation">[</span>
       <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-preset-env'</span><span class="token punctuation">)</span>
     <span class="token punctuation">]</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// postcss.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'postcss-preset-env'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="file-loader"><a href="#file-loader" class="header-anchor">#</a> file-loader</h4> <ul><li>要处理jpg、png等格式的图片，我们也需要有对应的loader：file-loader
<ul><li>file-loader的作用就是帮助我们处理import/require()方式引入的一个文件资源，并且会将它放到我们输出的 文件夹中；</li></ul></li> <li><code>npm install file-loader -D</code></li> <li>配置处理图片的Rule：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|svg)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>文件的名称规则
<ul><li>有时候我们处理后的文件名称按照一定的规则进行显示：
<ul><li>比如保留原来的文件名、扩展名，同时为了防止重复，包含一个hash值等；</li></ul></li> <li>这个时候我们可以使用PlaceHolders来完成，webpack给我们提供了大量的PlaceHolders来显示不同的内容</li> <li>我们这里介绍几个最常用的placeholder：
<ul><li><code>[ext]：处理文件的扩展名；</code></li> <li><code>[name]：处理文件的名称；</code></li> <li><code>[hash]：文件的内容，使用MD4的散列函数处理，生成的一个128位的hash值（32个十六进制）；</code></li> <li><code>[contentHash]：在file-loader中和[hash]结果是一致的（在webpack的一些其他地方不一样，后面会讲到）；</code></li> <li><code>[hash:&lt;length&gt;]：截图hash的长度，默认32个字符太长了；</code></li> <li><code>[path]：文件相对于webpack配置文件的路径；</code></li></ul></li></ul></li> <li>设置文件名称
- 这个也是vue的写法
<code>js // webpack.config.js { test: /\.(png|jpe?g|gif|svg)$/, use: [ { loader: 'file-loader', options: { name: &quot;img/[name].[hash:6].[ext]&quot;, } } ] }</code></li> <li>设置文件的存放路径
<ul><li>通过 img/ 已经设置了文件夹，这个也是vue、react脚手架中常见的设置方式：
<ul><li>其实按照这种设置方式就可以了；</li> <li>当然我们也可以通过outputPath来设置输出的文件夹；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|svg)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&quot;[name].[hash:6].[ext]&quot;</span><span class="token punctuation">,</span>
          outputPath<span class="token operator">:</span><span class="token string">'img'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li></ul> <h4 id="url-loader"><a href="#url-loader" class="header-anchor">#</a> url-loader</h4> <ul><li>url-loader和file-loader的工作方式是相似的，但是可以将较小的文件，转成base64的URI。</li> <li><code>npm install url-loader -D</code></li> <li>默认情况下url-loader会将所有的图片文件转成base64编码</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//webpack.config.js</span>
<span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|svg)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&quot;img/[name].[hash:6].[ext]&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>url-loader的limit
<ul><li>但是开发中我们往往是小的图片需要转换，但是大的图片直接使用图片即可
<ul><li>这是因为小的图片转换base64之后可以和页面一起被请求，减少不必要的请求过程；</li> <li>而大的图片也进行转换，反而会影响页面的请求速度；</li></ul></li> <li>我们如何可以限制哪些大小的图片转换和不转换呢？
<ul><li>url-loader有一个options属性limit，可以用于设置转换的限制；</li> <li>下面的代码38kb的图片会进行base64编码，而295kb的不会；</li></ul></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|svg)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              name<span class="token operator">:</span> <span class="token string">&quot;[name].[hash:6].[ext]&quot;</span><span class="token punctuation">,</span>
              outputPath<span class="token operator">:</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">,</span>
              limit<span class="token operator">:</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">1024</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="自定义loader"><a href="#自定义loader" class="header-anchor">#</a> 自定义Loader</h3> <h4 id="创建自己的loader"><a href="#创建自己的loader" class="header-anchor">#</a> 创建自己的Loader</h4> <ul><li>Loader是用于对模块的源代码进行转换（处理），之前我们已经使用过很多Loader，比如css-loader、style-loader、babel-loader等。</li> <li>如何自定义自己的Loader：
<ul><li>Loader本质上是一个导出为函数的JavaScript模块；</li> <li>loader-runner库会调用这个函数，然后将上一个loader产生的结果或者资源文件传入进去；</li></ul></li> <li>编写一个hy-loader.js模块这个函数会接收三个参数
<ul><li>content：资源文件的内容；</li> <li>map：sourcemap相关的数据；</li> <li>meta：一些元数据；</li></ul></li> <li>loader必须返回  buffer或者string</li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223190909.png" alt=""></p> <h4 id="在加载某个模块时-引入loader"><a href="#在加载某个模块时-引入loader" class="header-anchor">#</a> 在加载某个模块时，引入loader</h4> <p>传入的路径和context是有关系的。就是webpack中的content的路径配置
<code>content:path.resolve(__dirname,'.')</code> <img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223194959.png" alt=""></p> <h4 id="resolveloader属性"><a href="#resolveloader属性" class="header-anchor">#</a> resolveLoader属性</h4> <ul><li>但是，如果我们依然希望可以直接去加载自己的loader文件夹，有没有更加简洁的办法呢？
<ul><li>配置resolveLoader属性；</li></ul></li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223195038.png" alt=""></p> <h4 id="loader的执行顺序"><a href="#loader的执行顺序" class="header-anchor">#</a> loader的执行顺序</h4> <ul><li>创建多个Loader使用，它的执行顺序是什么呢？
<ul><li>从后向前、从右向左的</li></ul></li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223200528.png" alt=""></p> <h4 id="pitch-loader和enforce"><a href="#pitch-loader和enforce" class="header-anchor">#</a> pitch-loader和enforce</h4> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223201852.png" alt=""></p> <p>平常的Loader是NomalLoader。
事实上还有另一种Loader，称之为PitchLoader：
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223200931.png" alt=""> <img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223201057.png" alt=""></p> <h4 id="执行顺序和enforce"><a href="#执行顺序和enforce" class="header-anchor">#</a> 执行顺序和enforce</h4> <ul><li>其实这也是为什么loader的执行顺序是相反的：
<ul><li>run-loader先优先执行PitchLoader，在执行PitchLoader时进行loaderIndex++；</li> <li>run-loader之后会执行NormalLoader，在执行NormalLoader时进行loaderIndex--；</li></ul></li> <li>能不能改变它们的执行顺序呢？
<ul><li>我们可以拆分成多个Rule对象，通过enforce来改变它们的顺序；</li></ul></li> <li>enforce一共有四种方式：
<ul><li>默认所有的loader都是normal；</li> <li>在行内设置的loader是inline（在前面将css加载时讲过，import 'loader1!loader2!./test.js'）；</li> <li>也可以通过enforce设置 pre 和 post；</li></ul></li> <li>在Pitching和Normal它们的执行顺序分别是：
<ul><li>Pitching：post, inline, normal, pre；</li> <li>Normal：pre, normal, inline, post；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223202139.png" alt=""></li></ul></li></ul> <h4 id="同步的loader"><a href="#同步的loader" class="header-anchor">#</a> 同步的Loader</h4> <ul><li>什么是同步的Loader呢？
<ul><li><strong>函数结束的时候必须给返回东西</strong></li> <li>默认创建的Loader就是同步的Loader；</li> <li>这个Loader必须通过 return 或者 this.callback 来返回结果，交给下一个loader来处理；</li> <li>通常在有错误的情况下，我们会使用 this.callback；</li></ul></li> <li>this.callback的用法如下：
<ul><li>第一个参数必须是 Error 或者 null；</li> <li>第二个参数是一个 string或者Buffer；</li></ul></li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223202620.png" alt=""></p> <h4 id="异步的loader"><a href="#异步的loader" class="header-anchor">#</a> 异步的Loader</h4> <ul><li>什么是异步的Loader呢？
<ul><li>有时候我们使用Loader时会进行一些异步的操作；</li> <li>我们希望在异步操作完成后，再返回这个loader处理的结果；</li> <li>这个时候我们就要使用异步的Loader了；</li> <li>loader-runner已经在执行loader时给我们提供了方法，让loader变成一个异步的loader：</li></ul></li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223202806.png" alt=""></p> <h4 id="传入和获取参数"><a href="#传入和获取参数" class="header-anchor">#</a> 传入和获取参数</h4> <ul><li>在使用loader时，传入参数。</li> <li>们可以通过一个webpack官方提供的一个解析库 loader-utils，安装对应的库。
<ul><li><code>npm install loader-utils -D</code></li></ul></li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223203102.png" alt=""></p> <h4 id="校验参数"><a href="#校验参数" class="header-anchor">#</a> 校验参数</h4> <ul><li>我们可以通过一个webpack官方提供的校验库 schema-utils，安装对应的库：
<ul><li><code>npm install schema-utils -D</code></li></ul></li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223203246.png" alt=""></p> <h4 id="mybabel-loader案例分析"><a href="#mybabel-loader案例分析" class="header-anchor">#</a> mybabel-loader案例分析</h4> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223203521.png" alt=""></p> <h4 id="md-loader案例分析"><a href="#md-loader案例分析" class="header-anchor">#</a> md-loader案例分析</h4> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211223204206.png" alt=""></p> <h3 id="plugin"><a href="#plugin" class="header-anchor">#</a> Plugin</h3> <ul><li>Webpack的另一个核心是Plugin
<ul><li>Loader是用于特定的模块类型进行转换；</li> <li>Plugin可以用于执行更加广泛的任务，比如打包优化、资源管理、环境变量注入等；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211008200025.png" alt=""></li></ul></li></ul> <h4 id="cleanwebpackplugin"><a href="#cleanwebpackplugin" class="header-anchor">#</a> CleanWebpackPlugin</h4> <ul><li>每次修改了一些配置，重新打包时，都需要手动删除dist文件夹：
<ul><li>借助于一个插件来帮助我们完成，这个插件就是CleanWebpackPlugin；</li> <li><code>npm install clean-webpack-plugin -D</code></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;clean-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//导出配置信息</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="htmlwebpackplugin"><a href="#htmlwebpackplugin" class="header-anchor">#</a> HtmlWebpackPlugin</h4> <ul><li>不太规范的地方
<ul><li>HTML文件是编写在根目录下的，而最终打包的dist文件夹中是没有index.html文件的</li> <li>在进行项目部署的时，必然也是需要有对应的入口文件index.html；</li> <li>也需要对index.html进行打包处理；</li></ul></li> <li>对HTML进行打包处理我们可以使用另外一个插件：HtmlWebpackPlugin；</li> <li><code>npm install html-webpack-plugin -D</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span>
<span class="token comment">//导出配置信息</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">&quot;Html Webpack Plugin&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>生成的index.html分析
<ul><li>现在自动在dist文件夹中，生成了一个index.html的文件：
<ul><li>该文件中也自动添加了我们打包的bundle.js文件；</li></ul></li> <li>这个文件是如何生成的呢？
<ul><li>默认情况下是根据ejs的一个模板来生成的；</li> <li>在html-webpack-plugin的源码中，有一个default_index.ejs模块；</li></ul></li></ul></li> <li>自定义HTML模板
<ul><li>想在自己的模块中加入一些比较特别的内容
<ul><li>比如添加一个noscript标签，在用户的JavaScript被关闭时，给予响应的提示；</li> <li>比如在开发vue或者react项目时，我们需要一个可以挂载后续组件的根标签  <div id="app"></div>；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211008212633.png" alt=""></li></ul></li></ul></li> <li>自定义模板数据填充
<ul><li>会有一些类似这样的语法&lt;% 变量 %&gt;，这个是EJS模块填充数据的方式。</li> <li>配置HtmlWebpackPlugin时，我们可以添加如下配置：
<ul><li>template：指定我们要使用的模块所在的路径；</li> <li>title：在进行htmlWebpackPlugin.options.title读取时，就会读到该信息；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211008212745.png" alt=""></li></ul></li></ul></li></ul> <h4 id="defineplugin"><a href="#defineplugin" class="header-anchor">#</a> DefinePlugin</h4> <ul><li>DefinePlugin
<ul><li>这个时候编译还是会报错，因为在我们的模块中还使用到一个BASE_URL的常量</li> <li>因为在编译template模块时，有一个BASE_URL：
<ul><li><code>&lt;link rel=&quot;icon&quot; href=&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;&gt;；</code></li> <li>但是我们并没有设置过这个常量值，所以会出现没有定义的错误；</li></ul></li> <li>可以使用DefinePlugin插件；</li> <li>DefinePlugin允许在编译时创建配置的全局常量，是一个webpack内置的插件（不需要单独安装）：
<ul><li>编译template就可以正确的编译了，会读取到BASE_URL的值；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211008213039.png" alt=""></li></ul></li></ul></li></ul> <h4 id="copywebpackplugin"><a href="#copywebpackplugin" class="header-anchor">#</a> CopyWebpackPlugin</h4> <ul><li>CopyWebpackPlugin
<ul><li>在vue的打包过程中，如果我们将一些文件放到public的目录下，那么这个目录会被复制到dist文件夹中。
<ul><li>这个复制的功能，我们可以使用CopyWebpackPlugin来完成；</li></ul></li> <li><code>npm install copy-webpack-plugin -D</code></li> <li>接下来配置CopyWebpackPlugin即可
<ul><li>复制的规则在patterns中设置；</li> <li>from：设置从哪一个源中开始复制；</li> <li>to：复制到的位置，可以省略，会默认复制到打包的目录下；</li> <li>globOptions：设置一些额外的选项，其中可以编写需要忽略的文件：
<ul><li>.DS_Store：mac目录下回自动生成的一个文件；</li> <li>index.html：也不需要复制，因为我们已经通过HtmlWebpackPlugin完成了index.html的生成；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211008213322.png" alt=""></li></ul></li></ul></li></ul></li></ul> <h4 id="minicssextractplugin"><a href="#minicssextractplugin" class="header-anchor">#</a> MiniCssExtractPlugin</h4> <ul><li>MiniCssExtractPlugin可以帮助我们将css提取到一个独立的css文件中，该插件需要在webpack4+才可以使用。</li> <li>首先，我们需要安装mini-css-extract-plugin：<code>npm install mini-css-extract-plugin -D</code> <ul><li>配置rules和plugins：
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211104181915.png" alt=""></li></ul></li></ul></li></ul> <h3 id="自定义plugin"><a href="#自定义plugin" class="header-anchor">#</a> 自定义Plugin</h3> <h4 id="webpack和tapable"><a href="#webpack和tapable" class="header-anchor">#</a> Webpack和Tapable</h4> <ul><li>webpack有两个非常重要的类：Compiler和Compilation
<ul><li>他们通过注入插件的方式，来监听webpack的所有生命周期；</li> <li>插件的注入离不开各种各样的Hook，而他们的Hook是如何得到的呢？</li> <li>其实是创建了Tapable库中的各种Hook的实例；</li></ul></li> <li>所以，如果我们想要学习自定义插件，最好先了解一个库：Tapable
<ul><li>Tapable是官方编写和维护的一个库；</li> <li>Tapable是管理着需要的Hook，这些Hook可以被应用到我们的插件中；</li></ul></li></ul> <h4 id="tapable有哪些hook呢"><a href="#tapable有哪些hook呢" class="header-anchor">#</a> Tapable有哪些Hook呢？</h4> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211224201902.png" alt=""></p> <h4 id="tapable的hook分类"><a href="#tapable的hook分类" class="header-anchor">#</a> Tapable的Hook分类</h4> <ul><li>同步和异步的：
<ul><li>以sync开头的，是同步的Hook；</li> <li>以async开头的，两个事件处理回调，不会等待上一次处理回调结束后再执行下一次回调；</li></ul></li> <li>其他的类别
<ul><li>bail：当有返回值时，就不会执行后续的事件触发了；</li> <li>Loop：当返回值为true，就会反复执行该事件，当返回值为undefined或者不返回内容，就退出事件；</li> <li>Waterfall：当返回值不为undefined时，会将这次返回的结果作为下次事件的第一个参数；</li> <li>Parallel：并行，会同时执行次事件处理回调结束，才执行下一次事件处理回调；</li> <li>Series：串行，会等待上一是异步的Hook；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> SyncHook<span class="token punctuation">,</span> SyncBailHook<span class="token punctuation">,</span> SyncLoopHook<span class="token punctuation">,</span> SyncWaterfallHook <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;tapable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> AsyncSeriesHook<span class="token punctuation">,</span> AsyncParallelHook <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'tapable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LearnTapable</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token comment">// syncHook: new SyncHook([&quot;name&quot;, &quot;age&quot;])</span>
      <span class="token comment">// bail: 在某一个事件监听的函数中, 如果有返回值, 那么后续的监听的事件就不会执行了</span>
      <span class="token comment">// syncHook: new SyncBailHook([&quot;name&quot;, &quot;age&quot;])</span>
      <span class="token comment">// loop:在某个时间监听的函数中, 如果返回值为true, 那么这个回调函数就会循环执行.(返回undefined, 就停止执行)</span>
      <span class="token comment">// syncHook: new SyncLoopHook([&quot;name&quot;, &quot;age&quot;])</span>
      <span class="token comment">// waterfall: 在某个时间监听的函数中, 如果有返回值, 那么它的返回值会作为下一次事件监听函数的第一个参数</span>
      syncHook<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncWaterfallHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

      <span class="token comment">// series: 在一个hook中, 监听了多次事件(多个回调函数), 这两个回调函数是串行执行</span>
      asyncHook<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">AsyncSeriesHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

      <span class="token comment">// parallel: 在一个hook中, 监听了多次事件(多个回调函数), 这两个回调函数是并行执行</span>
      <span class="token comment">// asyncHook: new AsyncParallelHook([&quot;name&quot;, &quot;age&quot;])</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// this.hooks.syncHook.tap(&quot;event1&quot;, (name, age) =&gt; {</span>
    <span class="token comment">//   console.log(&quot;event1&quot;, name, age);</span>
    <span class="token comment">//   return &quot;event1&quot;;</span>
    <span class="token comment">// });</span>

    <span class="token comment">// this.hooks.syncHook.tap(&quot;event2&quot;, (name, age) =&gt; {</span>
    <span class="token comment">//   console.log(&quot;event2&quot;, name, age);</span>
    <span class="token comment">// });</span>

    <span class="token comment">// this.hooks.asyncHook.tapAsync(&quot;event1&quot;, (name, age, callback) =&gt; {</span>
    <span class="token comment">//   setTimeout(() =&gt; {</span>
    <span class="token comment">//     console.log(&quot;event1&quot;, name, age);</span>
    <span class="token comment">//     callback();</span>
    <span class="token comment">//   }, 2000);</span>
    <span class="token comment">// });</span>

    <span class="token comment">// this.hooks.asyncHook.tapAsync(&quot;event2&quot;, (name, age, callback) =&gt; {</span>
    <span class="token comment">//   setTimeout(() =&gt; {</span>
    <span class="token comment">//     console.log(&quot;event2&quot;, name, age);</span>
    <span class="token comment">//     callback();</span>
    <span class="token comment">//   }, 2000);</span>
    <span class="token comment">// });</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>asyncHook<span class="token punctuation">.</span><span class="token function">tapPromise</span><span class="token punctuation">(</span><span class="token string">&quot;event1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;event1&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>asyncHook<span class="token punctuation">.</span><span class="token function">tapPromise</span><span class="token punctuation">(</span><span class="token string">&quot;event2&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;event2&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this.hooks.syncHook.call(&quot;why&quot;, 18);</span>

    <span class="token comment">// this.hooks.asyncHook.callAsync(&quot;kobe&quot;, 30, () =&gt; {</span>
    <span class="token comment">//   console.log(&quot;第一次事件执行完成&quot;);</span>
    <span class="token comment">// });</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>asyncHook<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token string">&quot;james&quot;</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;事件监听完成&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> lt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LearnTapable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lt<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br></div></div><h3 id="hook的使用过程"><a href="#hook的使用过程" class="header-anchor">#</a> Hook的使用过程</h3> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211224204845.png" alt=""></p> <h4 id="自定义plugin-2"><a href="#自定义plugin-2" class="header-anchor">#</a> 自定义Plugin</h4> <ul><li>在之前的学习中，我们已经使用了非常多的Plugin：
<ul><li>CleanWebpackPlugin</li> <li>HTMLWebpackPlugin</li> <li>MiniCSSExtractPlugin</li> <li>CompressionPlugin</li> <li>....</li></ul></li> <li>这些Plugin是如何被注册到webpack的生命周期中的呢？
<ul><li>第一：在webpack函数的createCompiler方法中，注册了所有的插件；</li> <li>第二：在注册插件时，会调用插件函数或者插件对象的apply方法；</li> <li>第三：插件方法会接收compiler对象，我们可以通过compiler对象来注册Hook的事件；</li> <li>第四：某些插件也会传入一个compilation的对象，我们也可以监听compilation的Hook事件；</li></ul></li></ul> <h4 id="开发自己的插件"><a href="#开发自己的插件" class="header-anchor">#</a> 开发自己的插件</h4> <ul><li>如何开发自己的插件呢？
<ul><li>目前大部分插件都可以在社区中找到，但是推荐尽量使用在维护，并且经过社区验证的；</li> <li>这里我们开发一个自己的简单插件：将静态文件自动上传服务器中；</li></ul></li> <li>自定义插件的过程：
<ul><li>创建AutoUploadWebpackPlugin类；</li> <li>编写apply方法：
<ul><li>通过ssh连接服务器；</li> <li>删除服务器原来的文件夹；</li> <li>上传文件夹中的内容；</li></ul></li> <li>在webpack的plugins中，使用AutoUploadWebpackPlugin类；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> NodeSSH <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;node-ssh&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AutoUploadPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// nodessh</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ssh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NodeSSH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 其他的参数</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 监听某个hook下的某个钩子事件（声明周期）</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>afterEmit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span>
      <span class="token string">&quot;AutoUploadPlugin&quot;</span><span class="token punctuation">,</span>
      <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.获取输出的文件夹</span>
        <span class="token keyword">const</span> outputPath <span class="token operator">=</span> compilation<span class="token punctuation">.</span>outputOptions<span class="token punctuation">.</span>path<span class="token punctuation">;</span>
        <span class="token comment">// 2.连接服务器(ssh连接)</span>
        <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">connectServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 3.删除原来目录中的内容</span>
        <span class="token keyword">const</span> serverDir <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>remotePath<span class="token punctuation">;</span>
        <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rm -rf </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>serverDir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 4.上传文件到服务器(ssh连接)</span>
        <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">uploadFiles</span><span class="token punctuation">(</span>outputPath<span class="token punctuation">,</span> serverDir<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 5.关闭ssh</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 连接ssh</span>
  <span class="token keyword">async</span> <span class="token function">connectServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      host<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>host<span class="token punctuation">,</span>
      username<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
      password<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>password<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;连接成功~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 上传文件夹</span>
  <span class="token keyword">async</span> <span class="token function">uploadFiles</span><span class="token punctuation">(</span><span class="token parameter">localPath<span class="token punctuation">,</span> remotePath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> status <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">putDirectory</span><span class="token punctuation">(</span>localPath<span class="token punctuation">,</span> remotePath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      recursive<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      concurrency<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;传送到服务器: &quot;</span><span class="token punctuation">,</span> status <span class="token operator">?</span> <span class="token string">&quot;成功&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> AutoUploadPlugin<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h3 id="asset-module-type"><a href="#asset-module-type" class="header-anchor">#</a> asset  module  type</h3> <ul><li>当前使用的webpack版本是webpack5
<ul><li>在webpack5之前，加载这些资源我们需要使用一些loader，比如raw-loader 、url-loader、file-loader；</li> <li>在webpack5之后，我们可以直接使用资源模块类型（asset module type），来替代上面的这些loader；</li></ul></li> <li>资源模块类型(asset module type)，通过添加 4 种新的模块类型，来替换所有这些 loader：
<ul><li>asset/resource 发送一个单独的文件并导出 URL。之前通过使用 file-loader 实现；</li> <li>asset/inline 导出一个资源的 data URI。之前通过使用 url-loader 实现；</li> <li>asset/source 导出资源的源代码。之前通过使用 raw-loader 实现；</li> <li>asset 在导出一个 data URI 和发送一个单独的文件之间自动选择。之前通过使用 url-loader，并且配置资源 体积限制实现；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>

<span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|svg)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    type<span class="token operator">:</span><span class="token string">'asset/resource'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>可以自定义文件的输出路径和文件名
<ul><li>方式一：修改output，添加assetModuleFilename属性</li> <li>方式二：在Rule中，添加一个generator属性，并且设置filename
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211008204218.png" alt=""></li></ul></li> <li>url-loader的limit效果
<ul><li>步骤一：将type修改为asset；</li> <li>步骤二：添加一个parser属性，并且制定dataUrl的条件，添加maxSize属性；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211008211107.png" alt=""></li></ul></li></ul> <h3 id="浏览器兼容性"><a href="#浏览器兼容性" class="header-anchor">#</a> 浏览器兼容性</h3> <p><strong>开发中，浏览器的兼容性问题</strong>，我们应该如何去解决和处理？
这里指的兼容性是<strong>针对不同的浏览器支持的特性</strong>：比如css特性、js语法，之间的兼容性；</p> <ul><li><p>它们的市场占率是多少？我们要不要兼容它们呢？</p> <ul><li>其实在很多的脚手架配置中，都能看到类似于这样的配置信息：
<ul><li>这里的百分之一，就是指市场占有率
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210917143343.png" alt=""></li></ul></li></ul></li> <li><p>认识browserslist工具</p> <ul><li>如何可以在css兼容性和js兼容性下共享我们配置的兼容性条件呢？</li> <li>就是当我们<strong>设置了一个条件： &gt; 1%</strong>；</li> <li><strong>css要兼容市场占有率大于1%的浏览器，js也要兼容市场占有率大于1%的浏览器；</strong></li> <li>通过工具来达到这种兼容性的，比如后面ostcss-prest-env、babel、autoprefixer等</li></ul></li> <li><p>如何可以让他们共享我们的配置呢？</p> <ul><li>这个问题的答案就是Browserslist；</li></ul></li> <li><p>Browserslist是什么？Browserslist是一个在不同的前端工具之间，共享目标浏览器和Node.js版本的配置：</p> <ul><li>Autoprefixer</li> <li>Babel</li> <li>postcss-preset-env</li> <li>eslint-plugin-compat</li> <li>stylelint-no-unsupported-browser-features</li> <li>postcss-normalize</li> <li>obsolete-webpack-plugin
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210917144705.png" alt=""> <img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210917144744.png" alt=""></li></ul></li> <li><p>命令行使用browserslist</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npx browserslist <span class="token string">&quot;&gt;1%, last 2 version, not dead&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210917144957.png" alt=""></p></li> <li><p>配置browserslist
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20210917145026.png" alt=""></p></li></ul> <h3 id="hash、contenthash、chunkhash"><a href="#hash、contenthash、chunkhash" class="header-anchor">#</a> Hash、ContentHash、ChunkHash</h3> <ul><li>在我们给打包的文件进行命名的时候，会使用placeholder，placeholder中有几个属性比较相似：
<ul><li>hash、chunkhash、contenthash</li> <li>hash本身是通过MD4的散列函数处理后，生成一个128位的hash值（32个十六进制）；</li></ul></li> <li>hash值的生成和整个项目有关系：
<ul><li>比如我们现在有两个入口index.js和main.js；</li> <li>它们分别会输出到不同的bundle文件中，并且在文件名称中我们有使用hash；</li> <li>这个时候，如果修改了index.js文件中的内容，那么hash会发生变化；</li> <li>那就意味着两个文件的名称都会发生变化；</li> <li>如果都使用hash的话，因为这是工程级别的，即每次修改任何一个文件，所有文件名的hash至都将改变。所以一旦修改了任何一个文件，整个项目的文件缓存都将失效。</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211104182914.png" alt=""></li></ul></li> <li>chunkhash可以有效的解决上面的问题，它会根据不同的入口进行借来解析来生成hash值：
<ul><li>比如我们修改了index.js，那么main.js的chunkhash是不会发生改变的；</li> <li>chunkhash根据不同的入口文件(Entry)进行依赖文件解析、构建对应的chunk，生成对应的哈希值。在生产环境里把一些公共库和程序入口文件区分开，单独打包构建，接着我们采用chunkhash的方式生成哈希值，那么只要我们不改动公共库的代码，就可以保证其哈希值不会受影响。</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211104183111.png" alt=""></li> <li>可以清晰地看见每个chunk模块的hash是不一样的了。</li> <li>因为我们是将样式作为模块import到JavaScript文件中的，所以它们的chunkhash是一致的，如test1.js和test1.css：
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211104183248.png" alt=""></li></ul></li> <li>这样就会有个问题，只要对应css或则js改变，与其关联的文件hash值也会改变，但其内容并没有改变呢，所以没有达到缓存意义。固contenthash的用途随之而来。</li></ul></li> <li>contenthash表示生成的文件hash名称，只和内容有关系：
<ul><li>比如我们的index.js，引入了一个style.css，style.css有被抽取到一个独立的css文件中；</li> <li>这个css文件在命名时，如果我们使用的是chunkhash；</li> <li>那么当index.js文件的内容发生变化时，css文件的命名也会发生变化；</li> <li>这个时候我们可以使用contenthash；</li> <li>contenthash是针对文件内容级别的，只有你自己模块的内容变了，那么hash值才改变，所以我们可以通过contenthash解决上诉问题。</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211104183430.png" alt=""></li></ul></li></ul> <h3 id="模块化原理"><a href="#模块化原理" class="header-anchor">#</a> 模块化原理</h3> <h4 id="mode配置"><a href="#mode配置" class="header-anchor">#</a> Mode配置</h4> <ul><li>Mode配置选项，可以告知webpack使用响应模式的内置优化：
<ul><li>默认值是production（什么都不设置的情况下）；</li> <li>可选值有：'none' | 'development' | 'production'；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009112007.png" alt=""></li></ul></li></ul> <h4 id="webpack的模块化"><a href="#webpack的模块化" class="header-anchor">#</a> Webpack的模块化</h4> <ul><li>Webpack打包的代码，允许我们使用各种各样的模块化，但是最常用的是CommonJS、ES Module。</li> <li>CommonJS模块化实现原理；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 定义了一个对象</span>
<span class="token comment">// 模块的路径(key): 函数(value)</span>
<span class="token keyword">var</span> __webpack_modules__ <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;./src/js/format.js&quot;</span><span class="token operator">:</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token function-variable function">dateFormat</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;2020-12-12&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> <span class="token function-variable function">priceFormat</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">price</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;100.00&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 将我们要导出的变量, 放入到module对象中的exports对象</span>
      module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
        dateFormat<span class="token punctuation">,</span>
        priceFormat
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 定义一个对象, 作为加载模块的缓存</span>
<span class="token keyword">var</span> __webpack_module_cache__ <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 是一个函数, 当我们加载一个模块时, 都会通过这个函数来加载</span>
<span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1.判断缓存中是否已经加载过</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>__webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> __webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 2.给module变量和__webpack_module_cache__[moduleId]赋值了同一个对象</span>
  <span class="token keyword">var</span> module <span class="token operator">=</span> __webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// 3.加载执行模块</span>
  __webpack_modules__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 4.导出module.exports {dateFormat: function, priceForamt: function}</span>
  <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 具体开始执行代码逻辑</span>
<span class="token operator">!</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1.加载./src/js/format.js</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> dateFormat<span class="token punctuation">,</span> priceFormat <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">&quot;./src/js/format.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">dateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">priceFormat</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><ul><li>ES Module实现原理；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1.定义了一个对象, 对象里面放的是我们的模块映射</span>
<span class="token keyword">var</span> __webpack_modules__ <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;./src/es_index.js&quot;</span><span class="token operator">:</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">__unused_webpack_module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 调用r的目的是记录时一个__esModule -&gt; true</span>
      __webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// _js_math__WEBPACK_IMPORTED_MODULE_0__ == exports</span>
      <span class="token keyword">var</span> _js_math__WEBPACK_IMPORTED_MODULE_0__ <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">&quot;./src/js/math.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_js_math__WEBPACK_IMPORTED_MODULE_0__<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_js_math__WEBPACK_IMPORTED_MODULE_0__<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  <span class="token string">&quot;./src/js/math.js&quot;</span><span class="token operator">:</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">__unused_webpack_module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      __webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 调用了d函数: 给exports设置了一个代理definition</span>
      <span class="token comment">// exports对象中本身是没有对应的函数</span>
      __webpack_require__<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;sum&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> sum<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;mul&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> mul<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> <span class="token function-variable function">mul</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> num1 <span class="token operator">*</span> num2<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 2.模块的缓存</span>
<span class="token keyword">var</span> __webpack_module_cache__ <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 3.require函数的实现(加载模块)</span>
<span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>__webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> __webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> module <span class="token operator">=</span> __webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  __webpack_modules__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 做代理</span>
<span class="token operator">!</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// __webpack_require__这个函数对象添加了一个属性: d -&gt; 值function</span>
  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">d</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> definition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> definition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>definition<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span> enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> get<span class="token operator">:</span> definition<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// __webpack_require__这个函数对象添加了一个属性: o -&gt; 值function</span>
  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">o</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// __webpack_require__这个函数对象添加了一个属性: r -&gt; 值function</span>
  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">r</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Symbol <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'Module'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">'__esModule'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">&quot;./src/es_index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><ul><li>CommonJS加载ES Module的原理；</li> <li>ES Module加载CommonJS的原理；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> __webpack_modules__ <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">&quot;./src/index.js&quot;</span><span class="token operator">:</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">__unused_webpack_module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
      __webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> _js_format__WEBPACK_IMPORTED_MODULE_0__ <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">&quot;./src/js/format.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> _js_format__WEBPACK_IMPORTED_MODULE_0___default <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">n</span><span class="token punctuation">(</span>_js_format__WEBPACK_IMPORTED_MODULE_0__<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// es module导出内容, CommonJS导入内容</span>
      <span class="token keyword">const</span> math <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">&quot;./src/js/math.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// CommonJS导出内容, es module导入内容</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">_js_format__WEBPACK_IMPORTED_MODULE_0___default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">_js_format__WEBPACK_IMPORTED_MODULE_0___default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">priceFormat</span><span class="token punctuation">(</span><span class="token string">&quot;bbb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string">&quot;./src/js/format.js&quot;</span><span class="token operator">:</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token function-variable function">dateFormat</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;2020-12-12&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> <span class="token function-variable function">priceFormat</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">price</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;100.00&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
        dateFormat<span class="token punctuation">,</span>
        priceFormat
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token string">&quot;./src/js/math.js&quot;</span><span class="token operator">:</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">__unused_webpack_module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      __webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span><span class="token punctuation">;</span>
      __webpack_require__<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;sum&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> sum<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;mul&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> mul<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> <span class="token function-variable function">mul</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> num1 <span class="token operator">*</span> num2<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> __webpack_module_cache__ <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// The require function</span>
<span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Check if module is in cache</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>__webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> __webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Create a new module (and put it into the cache)</span>
  <span class="token keyword">var</span> module <span class="token operator">=</span> __webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// no module.id needed</span>
    <span class="token comment">// no module.loaded needed</span>
    exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// Execute the module function</span>
  __webpack_modules__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Return the exports of the module</span>
  <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">!</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// getDefaultExport function for compatibility with non-harmony modules</span>
  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">n</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> getter <span class="token operator">=</span> module <span class="token operator">&amp;&amp;</span> module<span class="token punctuation">.</span>__esModule <span class="token operator">?</span>
      <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> module<span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">:</span>
      <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> module<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>getter<span class="token punctuation">,</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> getter <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> getter<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* webpack/runtime/define property getters */</span>
<span class="token operator">!</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// define getter functions for harmony exports</span>
  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">d</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> definition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> definition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>definition<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span> enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> get<span class="token operator">:</span> definition<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* webpack/runtime/hasOwnProperty shorthand */</span>
<span class="token operator">!</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">o</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* webpack/runtime/make namespace object */</span>
<span class="token operator">!</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// define __esModule on exports</span>
  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">r</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Symbol <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'Module'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">'__esModule'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br></div></div><h3 id="source-map"><a href="#source-map" class="header-anchor">#</a> source-map</h3> <h4 id="认识source-map"><a href="#认识source-map" class="header-anchor">#</a> 认识source-map</h4> <ul><li>我们的代码通常运行在浏览器上时，是通过打包压缩的：
<ul><li>也就是真实跑在浏览器上的代码，和我们编写的代码其实是有差异的；</li> <li>比如ES6的代码可能被转换成ES5；</li> <li>比如对应的代码行号、列号在经过编译后肯定会不一致；</li> <li>比如代码进行丑化压缩时，会将编码名称等修改；</li> <li>比如我们使用了TypeScript等方式编写的代码，最终转换成JavaScript；</li></ul></li> <li>但是，当代码报错需要调试时（debug），调试转换后的代码是很困难的</li> <li>如何可以调试这种转换后不一致的代码呢？答案就是source-map
<ul><li>source-map是从已转换的代码，映射到原始的源文件；</li> <li>使浏览器可以重构原始源并在调试器中显示重建的原始源；</li></ul></li></ul> <h4 id="使用source-map"><a href="#使用source-map" class="header-anchor">#</a> 使用source-map</h4> <ul><li>如何可以使用source-map呢？两个步骤：
<ul><li>第一步：根据源文件，生成source-map文件，webpack在打包时，可以通过配置生成source-map</li> <li>第二步：在转换后的代码，最后添加一个注释，它指向sourcemap；</li> <li><code>//# sourceMappingURL=common.bundle.js.map</code></li></ul></li> <li>浏览器会根据我们的注释，查找响应的source-map，并且根据source-map还原我们的代码，方便进行调试。</li> <li>在Chrome中，我们可以按照如下的方式打开source-map：
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009125923.png" alt=""></li></ul> <h4 id="分析source-map"><a href="#分析source-map" class="header-anchor">#</a> 分析source-map</h4> <ul><li>最初source-map生成的文件带下是原始文件的10倍，第二版减少了约50%，第三版又减少了50%，所以目前一个 133kb的文件，最终的source-map的大小大概在300kb。</li> <li>目前的source-map长什么样子呢？
<ul><li>version：当前使用的版本，也就是最新的第三版；</li> <li>sources：从哪些文件转换过来的source-map和打包的代码（最初始的文件）；</li> <li>names：转换前的变量和属性名称（因为我目前使用的是development模式，所以不需要保留转换前的名称）</li> <li>mappings：source-map用来和源文件映射的信息（比如位置信息等），一串base64  VLQ（veriable- length quantity可变长度值）编码；</li> <li>file：打包后的文件（浏览器加载的文件）；</li> <li>sourceContent：转换前的具体代码信息（和sources是对应的关系）；</li> <li>sourceRoot：所有的sources相对的根目录；</li></ul></li></ul> <h4 id="生成source-map"><a href="#生成source-map" class="header-anchor">#</a> 生成source-map</h4> <ul><li>使用webpack打包的时候，生成对应的source-map呢？
<ul><li>webpack为我们提供了非常多的选项（目前是26个），来处理source-map；</li> <li>https://webpack.docschina.org/configuration/devtool/</li> <li>选择不同的值，生成的source-map会稍微有差异，打包的过程也会有<strong>性能的差异</strong>，可以根据不同的情况进行 选择；</li></ul></li> <li>下面几个值不会生成source-map
<ul><li>false：不使用source-map，也就是没有任何和source-map相关的内容。</li> <li>none：production模式下的默认值，不生成source-map。</li> <li>eval：development模式下的默认值，不生成source-map
<ul><li>但是它会在eval执行的代码中，添加 <code>//# sourceURL=</code>；</li> <li>它会被浏览器在执行时解析，并且在调试面板中生成对应的一些文件目录，方便我们调试代码；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009193042.png" alt=""></li></ul></li></ul></li></ul> <h4 id="source-map值"><a href="#source-map值" class="header-anchor">#</a> source-map值</h4> <ul><li><p>source-map值：</p> <ul><li>生成一个独立的source-map文件，并且在bundle文件中有一个注释，指向source-map文件；</li> <li>bundle文件中有如下的注释
<ul><li>开发工具会根据这个注释找到source-map文件，并且解析；
<ul><li><code>//# sourceMappingURL=bundle.js.map</code></li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009193206.png" alt=""></li></ul></li></ul></li></ul></li> <li><p>eval-source-map值</p> <ul><li>会生成sourcemap，但是source-map是以DataUrl添加到eval函数的后面
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009193314.png" alt=""></li></ul></li> <li><p>inline-source-map值</p> <ul><li>会生成sourcemap，但是source-map是以DataUrl添加到bundle文件的后面
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009193432.png" alt=""></li></ul></li> <li><p>cheap-source-map</p> <ul><li>会生成sourcemap，但是会更加高效一些（cheap低开销），因为它没有生成列映射（Column Mapping）</li> <li>因为在开发中，我们只需要行信息通常就可以定位到错误了
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009193717.png" alt=""></li> <li>能找到是哪行出错，不能精确到这行的那个地方</li></ul></li> <li><p>cheap-module-source-map</p> <ul><li>会生成sourcemap，类似于cheap-source-map，但是对源自loader的sourcemap处理会更好。
<ul><li>其实是如果loader对我们的源码进行了特殊的处理，比如babel；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009195216.png" alt=""></li></ul></li></ul></li> <li><p>hidden-source-map值</p> <ul><li>会生成sourcemap，但是不会对source-map文件进行引用；</li> <li>相当于删除了打包文件中对sourcemap的引用注释；</li> <li><code>// 被删除掉的 //# sourceMappingURL=bundle.js.map</code></li> <li>如果我们手动添加进来，那么sourcemap就会生效了</li></ul></li> <li><p>nosources-source-map值</p> <ul><li>会生成sourcemap，但是生成的sourcemap只有错误信息的提示，不会生成源代码文件；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009195502.png" alt=""></li></ul></li> <li><p>多个值的组合</p> <ul><li>webpack提供给我们的26个值，是可以进行多组合的。</li> <li>组合的规则如下：
<ul><li>inline-|hidden-|eval：三个值时三选一；</li> <li>nosources：可选值；</li> <li>cheap可选值，并且可以跟随module的值；</li></ul></li> <li><code>[inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</code></li> <li>那么在开发中，最佳的实践是什么呢？
<ul><li>开发阶段：推荐使用  source-map或者cheap-module-source-map
<ul><li>这分别是vue和react使用的值，可以获取调试信息，方便快速开发；</li></ul></li> <li>测试阶段：推荐使用  source-map或者cheap-module-source-map
<ul><li>测试阶段我们也希望在浏览器下看到正确的错误提示；</li></ul></li> <li>发布阶段：false、缺省值（不写）</li></ul></li></ul></li></ul> <h3 id="babel的深入解析"><a href="#babel的深入解析" class="header-anchor">#</a> Babel的深入解析</h3> <h4 id="为什么需要babel"><a href="#为什么需要babel" class="header-anchor">#</a> 为什么需要babel？</h4> <ul><li>事实上，在开发中我们很少直接去接触babel，但是babel对于前端开发来说，目前是不可缺少的一部分：
<ul><li>开发中，我们想要使用ES6+的语法，想要使用TypeScript，开发React项目，它们都是离不开Babel的；</li> <li>所以，学习Babel对于我们理解代码从编写到线上的转变过程直观重要；</li></ul></li> <li>Babel到底是什么呢？
<ul><li>Babel是一个工具链，主要用于旧浏览器或者缓解中将ECMAScript 2015+代码转换为向后兼容版本的 JavaScript；</li> <li>包括：语法转换、源代码转换、Polyfill实现目标缓解缺少的功能等；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">n</span> <span class="token operator">=&gt;</span> n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> n
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li>Babel命令行使用
<ul><li>babel本身可以作为一个独立的工具（和postcss一样），不和webpack等构建工具配置来单独使用。</li> <li>如果我们希望在命令行尝试使用babel，需要安装如下库：
<ul><li>@babel/core：babel的核心代码，必须安装；</li> <li>@babel/cli：可以让我们在命令行使用babel；</li> <li><code>npm install @babel/cli @babel/core</code></li></ul></li> <li>使用babel来处理我们的源代码：
<ul><li>src：是源文件的目录；</li> <li>--out-dir：指定要输出的文件夹dist；</li> <li><code>npx babel src --out-dir dist</code></li></ul></li> <li>插件的使用
<ul><li>比如我们需要转换箭头函数，那么我们就可以使用箭头函数转换相关的插件：
<ul><li><code>npm install @babel/plugin-transform-arrow-functions -D</code></li> <li><code>npx babel src --out-dir dist --plugins=@babel/plugin-transform-arrow-functions</code></li></ul></li> <li>查看转换后的结果：我们会发现 const 并没有转成 var
<ul><li>这是因为 plugin-transform-arrow-functions，并没有提供这样的功能；</li> <li>我们需要使用 plugin-transform-block-scoping 来完成这样的功能；</li> <li><code>npm install @babel/plugin-transform-block-scoping -D</code></li> <li><code>npx babel src --out-dir dist --plugins=@babel/plugin-transform-block-scoping,@babel/plugin-transform-arrow-functions</code></li></ul></li></ul></li> <li>Babel的预设preset
<ul><li>但是如果要转换的内容过多，一个个设置是比较麻烦的，我们可以使用预设（preset）
<ul><li>后面我们再具体来讲预设代表的含义</li></ul></li> <li>安装@babel/preset-env预设:
<ul><li><code>npm install @babel/preset-env -D</code></li></ul></li> <li>执行如下命令
<ul><li><code>npx babel src --out-dir dist --presets=@babel/preset-env</code></li></ul></li></ul></li></ul></li></ul> <h4 id="babel的底层原理"><a href="#babel的底层原理" class="header-anchor">#</a> Babel的底层原理</h4> <ul><li>babel是如何做到将我们的一段代码（ES6、TypeScript、React）转成另外一段代码（ES5）的呢
<ul><li>从一种源代码（原生语言）转换成另一种源代码（目标语言），这是什么的工作呢？</li> <li>就是编译器，事实上我们可以将babel看成就是一个编译器。</li> <li>Babel编译器的作用就是将我们的源代码，转换成浏览器可以直接识别的另外一段源代码；</li></ul></li> <li>Babel也拥有编译器的工作流程：
<ul><li>解析阶段（Parsing）</li> <li>转换阶段（Transformation）</li> <li>生成阶段（Code Generation）</li> <li>https://github.com/jamiebuilds/the-super-tiny-compiler</li></ul></li></ul> <h4 id="babel编译器执行原理"><a href="#babel编译器执行原理" class="header-anchor">#</a> babel编译器执行原理</h4> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211009204321.png" alt=""></p> <ul><li>源代码</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;coderwhy&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>词法分析</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// tokens.js</span>
<span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Keyword&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;const&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;=&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;)&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;=&gt;&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;console&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;log&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;)&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;;&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;String&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;coderwhy\&quot;&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;)&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Punctuator&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;;&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br></div></div><ul><li>语法分析 生成AST</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Program&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclaration&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;declarations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclarator&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;init&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ArrowFunctionExpression&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CallExpression&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;callee&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MemberExpression&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;computed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token property">&quot;object&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;console&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;property&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;log&quot;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;arguments&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;generator&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">&quot;expression&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">&quot;async&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;kind&quot;</span><span class="token operator">:</span> <span class="token string">&quot;const&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ExpressionStatement&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;expression&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CallExpression&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;callee&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;arguments&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Literal&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;coderwhy&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;coderwhy\&quot;&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;script&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><ul><li>一系列操作后  生成新的AST</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Program&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclaration&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;declarations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclarator&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;init&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;FunctionExpression&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BlockStatement&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ReturnStatement&quot;</span><span class="token punctuation">,</span>
                  <span class="token property">&quot;argument&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CallExpression&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;callee&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MemberExpression&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;computed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;object&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;console&quot;</span>
                      <span class="token punctuation">}</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;property&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;log&quot;</span>
                      <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;arguments&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                      <span class="token punctuation">{</span>
                        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
                      <span class="token punctuation">}</span>
                    <span class="token punctuation">]</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;generator&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">&quot;expression&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">&quot;async&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;kind&quot;</span><span class="token operator">:</span> <span class="token string">&quot;var&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ExpressionStatement&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;expression&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CallExpression&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;callee&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;arguments&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Literal&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;coderwhy&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;coderwhy\&quot;&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;script&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br></div></div><h4 id="babel-loader"><a href="#babel-loader" class="header-anchor">#</a> babel-loader</h4> <ul><li><code>npm install babel-loader @babel/core</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//webpack.config.js</span>
<span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token comment">// options: {</span>
          <span class="token comment">//   presets: [</span>
          <span class="token comment">//     [&quot;@babel/preset-env&quot;, {</span>
          <span class="token comment">//       // targets: [&quot;chrome 88&quot;]</span>
          <span class="token comment">//       // enmodules: true</span>
          <span class="token comment">//     }]</span>
          <span class="token comment">//   ]</span>
          <span class="token comment">//   // plugins: [</span>
          <span class="token comment">//   //   &quot;@babel/plugin-transform-arrow-functions&quot;,</span>
          <span class="token comment">//   //   &quot;@babel/plugin-transform-block-scoping&quot;</span>
          <span class="token comment">//   // ]</span>
          <span class="token comment">// }</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="babel-preset"><a href="#babel-preset" class="header-anchor">#</a> babel-preset</h4> <p>一个个去安装使用插件，那么需要手动来管理大量的babel插件，我们可以直接给webpack提供一个 preset，webpack会根据我们的预设来加载对应的插件列表，并且将其传递给babel。</p> <ul><li>常见的预设有三个
<ul><li>env</li> <li>react</li> <li>TypeScript</li></ul></li> <li><code>npm install @babel/preset-env</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            presets<span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">]</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="设置目标浏览器-browserslist"><a href="#设置目标浏览器-browserslist" class="header-anchor">#</a> 设置目标浏览器  browserslist</h4> <ul><li><p>最终打包的JavaScript代码，是需要跑在目标浏览器上的，那么如何告知babel我们的目标浏览器呢？</p> <ul><li>browserslist工具</li> <li>target属性</li></ul></li> <li><p>之前我们项目中已经使用了browserslist工具，我们可以对比一下不同的配置，打包的区别：
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211011161757.png" alt=""></p></li> <li><p>设置目标浏览器  targets</p> <ul><li>也可以通过targets来进行配置</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">{</span>
      loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        presets<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            targets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;chrome 88&quot;</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">{</span>
      loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        presets<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            targets<span class="token operator">:</span> <span class="token string">&quot;last 2 versions&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>如果两个同时配置了，哪一个会生效呢？
<ul><li>配置的targets属性会覆盖browserslist；</li> <li>但是在开发中，更推荐通过browserslist来配置，因为类似于postcss工具，也会使用browserslist，进行统一浏览器 的适配；</li></ul></li></ul></li></ul> <h4 id="stage-x的preset"><a href="#stage-x的preset" class="header-anchor">#</a> Stage-X的preset</h4> <ul><li>新流程涉及四个不同的 Stage
<ul><li>Stage 0：strawman（稻草人），任何尚未提交作为正式提案的讨论、想法变更或者补充都被认为是第 0 阶段的&quot; 稻草人&quot;；</li> <li>Stage 1：proposal（提议），提案已经被正式化，并期望解决此问题，还需要观察与其他提案的相互影响；</li> <li>Stage 2：draft（草稿），Stage 2 的提案应提供规范初稿、草稿。此时，语言的实现者开始观察 runtime 的具体 实现是否合理；</li> <li>Stage 3：candidate（候补），Stage 3 提案是建议的候选提案。在这个高级阶段，规范的编辑人员和评审人员必 须在最终规范上签字。Stage 3 的提案不会有太大的改变，在对外发布之前只是修正一些问题；</li> <li>Stage 4：finished（完成），进入 Stage 4  的提案将包含在 ECMAScript 的下一个修订版中；</li></ul></li></ul> <h4 id="babel的stage-x设置"><a href="#babel的stage-x设置" class="header-anchor">#</a> Babel的Stage-X设置</h4> <ul><li>在babel7之前（比如babel6中），我们会经常看到这种设置方式：
<ul><li>它表达的含义是使用对应的 babel-preset-stage-x  预设；</li> <li>但是从babel7开始，已经不建议使用了，建议使用preset-env来设置；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            presets<span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token string">&quot;preset-env&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;preset-react&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;stage-3&quot;</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="babel的配置文件"><a href="#babel的配置文件" class="header-anchor">#</a> Babel的配置文件</h4> <ul><li>可以将babel的配置信息放到一个独立的文件中，babel给我们提供了两种配置文件的编写：
<ul><li>babel.config.json（或者.js，.cjs，.mjs）文件；</li> <li>.babelrc.json（或者.babelrc，.js，.cjs，.mjs）文件；</li></ul></li> <li>它们两个有什么区别呢？目前很多的项目都采用了多包管理的方式（babel本身、element-plus、umi等）；
<ul><li>.babelrc.json：早期使用较多的配置方式，但是对于配置Monorepos项目是比较麻烦的；、 babel.config.json（babel7）：可以直接作用于Monorepos项目的子包，更加推荐；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// babel.config.json </span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="polyfill"><a href="#polyfill" class="header-anchor">#</a> polyfill</h4> <ul><li>Polyfill是什么呢？
<ul><li>翻译：一种用于衣物、床具等的聚酯填充材料,  使这些物品更加温暖舒适；</li> <li>理解：更像是应该填充物（垫片），一个补丁，可以帮助我们更好的使用JavaScript；</li></ul></li> <li>为什么时候会用到polyfill呢？
<ul><li>比如我们使用了一些语法特性（例如：Promise,  Generator,  Symbol等以及实例方法例如 Array.prototype.includes等）</li> <li>但是某些浏览器压根不认识这些特性，必然会报错；</li> <li>我们可以使用polyfill来填充或者说打一个补丁，那么就会包含该特性了；</li></ul></li> <li>如何使用polyfill？
<ul><li>babel7.4.0之前，可以使用 @babel/polyfill的包，但是该包现在已经不推荐使用了：
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211011181126.png" alt="">
-babel7.4.0之后，可以通过单独引入core-js和regenerator-runtime来完成polyfill的使用：</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install core<span class="token operator">-</span>js regenerator<span class="token operator">-</span>runtime <span class="token operator">--</span>save

<span class="token comment">// 使用core-js regenerator-runtime的时候  我们要为webpack.config.js要排除一些内容</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211011181250.png" alt=""></p> <h4 id="配置babel-config-js"><a href="#配置babel-config-js" class="header-anchor">#</a> 配置babel.config.js</h4> <ul><li>在babel.config.js文件中进行配置，给preset-env配置一些属性
<ul><li><p>useBuiltIns：设置以什么样的方式来使用polyfill；</p> <ul><li>第一个值：false
<ul><li>打包后的文件不使用polyfill来进行适配；</li> <li>并且这个时候是不需要设置corejs属性的；</li></ul></li> <li>第二个值：usage
<ul><li>会根据源代码中出现的语言特性，自动检测所需要的polyfill；</li> <li>这样可以确保最终包里的polyfill数量的最小化，打包的包相对会小一些；</li> <li>可以设置corejs属性来确定使用的corejs的版本；</li></ul></li> <li>第三个值：entry
<ul><li>如果我们依赖的某一个库本身使用了某些polyfill的特性，但是因为我们使用的是usage，所以之后用户浏览器 可能会报错；</li> <li>所以，如果你担心出现这种情况，可以使用 entry；</li> <li>*并且需要在入口文件中添加  <code>import 'core-js/stable'; import 'regenerator-runtime/runtime'</code>;</li> <li>这样做会根据  browserslist 目标导入所有的polyfill，但是对应的包也会变大；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211011182831.png" alt=""></li></ul></li></ul></li> <li><p>corejs：设置corejs的版本，目前使用较多的是3.x的版本，比如我使用的是3.8.x的版本；</p> <ul><li>另外corejs可以设置是否对提议阶段的特性进行支持；</li> <li>设置 proposals属性为true即可；</li></ul></li> <li><p>Plugin-transform-runtime(编写第三方库的时候)</p> <ul><li>认识Plugin-transform-runtime
<ul><li>使用的polyfill，默认情况是添加的所有特性都是全局的
<ul><li>如果我们正在编写一个工具库，这个工具库需要使用polyfill；</li> <li>别人在使用我们工具时，工具库通过polyfill添加的特性，可能会污染它们的代码；</li> <li>所以，当编写工具时，babel更推荐我们使用一个插件： @babel/plugin-transform-runtime来完成polyfill 的功能；</li></ul></li></ul></li> <li>使用Plugin-transform-runtime
<ul><li><code>npm install @babel/plugin-transform-runtime -D</code> <img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211011183309.png" alt=""></li></ul></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token comment">// false: 不用任何的polyfill相关的代码</span>
      <span class="token comment">// usage: 代码中需要哪些polyfill, 就引用相关的api</span>
      <span class="token comment">// entry: 手动在入口文件中导入 core-js/regenerator-runtime, 根据目标浏览器引入所有对应的polyfill</span>
      <span class="token comment">// useBuiltIns: &quot;entry&quot;,</span>
      <span class="token comment">// corejs: 3</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">//用这个上面的 useBuiltIns就不需要了</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      corejs<span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="react的jsx支持"><a href="#react的jsx支持" class="header-anchor">#</a> React的jsx支持</h4> <ul><li>编写react代码时，react使用的语法是jsx，jsx是可以直接使用babel来转换的。</li> <li>react jsx代码进行处理需要如下的插件：
<ul><li>@babel/plugin-syntax-jsx</li> <li>@babel/plugin-transform-react-jsx</li> <li>@babel/plugin-transform-react-display-name</li></ul></li> <li><code>npm install @babel/preset-react -D</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//babel.config,js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token comment">// false: 不用任何的polyfill相关的代码</span>
      <span class="token comment">// usage: 代码中需要哪些polyfill, 就引用相关的api</span>
      <span class="token comment">// entry: 手动在入口文件中导入 core-js/regenerator-runtime, 根据目标浏览器引入所有对应的polyfill</span>
      <span class="token comment">// useBuiltIns: &quot;entry&quot;,</span>
      <span class="token comment">// corejs: 3</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="typescript的编译"><a href="#typescript的编译" class="header-anchor">#</a> TypeScript的编译</h4> <ul><li>使用TypeScript来开发，那么TypeScript代码是需要转换成JavaScript代码。</li> <li>可以通过TypeScript的compiler来转换成JavaScript：
<ul><li><code>npm install typescript -D</code></li></ul></li> <li>另外TypeScript的编译配置信息我们通常会编写一个tsconfig.json文件：
<ul><li><code>tsc --init</code></li> <li>生成配置文件如下：
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211011185803.png" alt=""></li> <li><code>npx tsc</code></li></ul></li> <li>使用ts-loader
<ul><li>在webpack中使用TypeScript，那么我们可以使用ts-loader来处理ts文件：
<ul><li><code>npm install ts-loader -D</code></li> <li>使用之前需要有<code>tsconfig.json</code>文件</li></ul></li> <li>问题：
<ul><li><strong>不支持Polyfill</strong></li> <li>需要
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211011185803.png" alt=""></li></ul></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token string">&quot;ts-loader&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>使用babel-loader
<ul><li>可以使用TypeScript Compiler来编译TypeScript之外，我们也可以使用Babel</li> <li>Babel是有对TypeScript进行支持；</li> <li>可以使用插件：<code>@babel/tranform-typescript</code></li> <li>更推荐直接使用<code>preset：@babel/preset-typescript</code></li> <li><code>npm install @babel/preset-typescript -D</code> <img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031083853.png" alt=""></li></ul></li> <li>ts-loader和babel-loader选择
<ul><li>ts-loader（TypeScript Compiler）
<ul><li>来直接编译TypeScript，那么只能将ts转换成js；</li> <li>如果我们还希望在这个过程中添加对应的polyfill，那么ts-loader是无能为力的；</li> <li>需要借助于babel来完成polyfill的填充功能；</li></ul></li> <li>babel-loader（Babel）
<ul><li>来直接编译TypeScript，也可以将ts转换成js，并且可以实现polyfill的功能；</li> <li>但是babel-loader在编译的过程中，不会对类型错误进行检测；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031101800.png" alt=""></li></ul></li> <li>同时保证两个情况都没有问题呢？
<ul><li>先使用Babel来完成代码的转换，使用tsc来进行类型的检查。
<ul><li>在scripts中添加了两个脚本，用于类型检查；</li> <li>执行<code>npm run type-check</code>可以对<code>ts</code>代码的类型进行检测；</li> <li>执行<code>npm run type-check-watch</code>可以实时的检测类型错误</li></ul></li></ul></li></ul></li></ul></li></ul> <h3 id="eslint"><a href="#eslint" class="header-anchor">#</a> ESLint</h3> <h4 id="认识eslint"><a href="#认识eslint" class="header-anchor">#</a> 认识ESLint</h4> <ul><li>什么是ESLint
<ul><li>ESLint是一个静态代码分析工具，在没有任何程序执行的情况下，对代码进行分析</li> <li>ESLint可以帮助我们在项目中建立统一的团队代码规范，保持正确、统一的代码风格，提高代码的可读性、可维护性；</li> <li>并且ESLint的规则是可配置的，我们可以自定义属于自己的规则；</li> <li>早期还有一些其他的工具，比如JSLint、JSHint、JSCS等，目前使用最多的是ESLint。</li></ul></li></ul> <h4 id="使用eslint"><a href="#使用eslint" class="header-anchor">#</a> 使用ESLint</h4> <ul><li>安装ESLint:<code>npm install eslint -D</code></li> <li>创建ESLint的配置文件:<code>npx eslint --init</code></li> <li>执行检测命令:<code>npx eslint ./src/main.js</code></li></ul> <h4 id="eslint的文件解析"><a href="#eslint的文件解析" class="header-anchor">#</a> ESLint的文件解析</h4> <ul><li>默认创建的环境如下
<ul><li>env：运行的环境，比如是浏览器，并且我们会使用es2021（对应的ecmaVersion是12）的语法；</li> <li>extends：可以扩展当前的配置，让其继承自其他的配置信息，可以跟字符串或者数组（多个）；</li> <li>parserOptions：这里可以指定ESMAScript的版本、sourceType的类型
<ul><li>parser：默认情况下是espree（也是一个JS Parser，用于ESLint），但是因为我们需要编译TypeScript，所以需要指定对应的解释器；</li></ul></li> <li>plugins：指定我们用到的插件；</li> <li>rules：自定义的一些规则；
<ul><li>配置的规则名称：对应的值值可以是数字、字符串、数组：</li> <li>字符串对应有三个值： off、warn、error；</li> <li>数字对应有三个值： 0、1、2（分别对应上面的值）;</li> <li>数组我们可以告知对应的提示以及希望获取到的值：比如 ['error','double']
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031105452.png" alt=""></li></ul></li></ul></li></ul> <h3 id="webpack中配置vue加载"><a href="#webpack中配置vue加载" class="header-anchor">#</a> Webpack中配置vue加载</h3> <ul><li>相关的依赖
<ul><li><code>npm install vue-loader -D</code></li> <li><code>npm install vue-template-compiler -D</code></li></ul></li> <li>配置webpack
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031102515.png" alt=""></li></ul> <h3 id="为什么要搭建本地服务器"><a href="#为什么要搭建本地服务器" class="header-anchor">#</a> 为什么要搭建本地服务器?</h3> <ul><li>目前我们开发的代码，为了运行需要有两个操作
<ul><li>操作一：npm run build，编译相关的代码；</li> <li>操作二：通过live server或者直接通过浏览器，打开index.html代码，查看效果；</li></ul></li> <li>这个过程经常操作会影响我们的开发效率，我们希望可以做到，当文件发生变化时，可以自动的完成 编译和 展示；</li> <li>为了完成自动编译，webpack提供了几种可选的方式：
<ul><li>webpack watch mode；</li> <li>webpack-dev-server；</li> <li>webpack-dev-middleware</li></ul></li></ul> <h4 id="webpack-watch"><a href="#webpack-watch" class="header-anchor">#</a> Webpack watch</h4> <ul><li>webpack给我们提供了watch模式：
<ul><li>在该模式下，webpack依赖图中的所有文件，只要有一个发生了更新，那么代码将被重新编译；</li> <li>我们不需要手动去运行 npm run build指令了；</li></ul></li> <li>如何开启watch呢？两种方式：
<ul><li>方式一：在导出的配置中，添加watch: true；</li> <li>方式二：在启动webpack的命令中，添加--watch的标识；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031104537.png" alt=""></li></ul></li> <li>效率并不是特别高:
<ul><li>对所有的源代码都重新进行编译</li> <li>编译成功后,都会生成新的文件(文件操作 file system)</li> <li>live-server属于VSCode插件(vim/webstorm) -&gt; 不属于webpack给我们的解决方案</li> <li>live-server每次都会重新刷新整个页面</li></ul></li></ul> <h4 id="webpack-dev-server"><a href="#webpack-dev-server" class="header-anchor">#</a> webpack-dev-server</h4> <ul><li><p>Webpack watch可以监听到文件的变化，但是事实上它本身是没有自动刷新浏览器的功能的：</p> <ul><li>当然，目前我们可以在VSCode中使用live-server来完成这样的功能；</li> <li>但是，我们希望在不适用live-server的情况下，可以具备live reloading（实时重新加载）的功能；</li></ul></li> <li><p>安装webpack-dev-server：<code>npm install --save-dev webpack-dev-server</code></p> <ul><li>不会生成新的文件，例如打包后的文件。</li></ul></li> <li><p>修改配置文件，告知 dev server，从什么位置查找文件：
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031104724.png" alt=""></p></li> <li><p>事实上webpack-dev-server使用了一个库叫memfs（memory-fs webpack自己写的）</p></li> <li><p>devServer(为开发过程服务的)的publicPath</p> <ul><li>devServer中也有一个publicPath的属性，该属性是指定本地服务所在的文件夹：
<ul><li>它的默认值是 /，也就是我们直接访问端口即可访问其中的资源http://localhost:8080；</li> <li>如果我们将其设置为了 /abc，那么我们需要通过 http://localhost:8080/abc才能访问到对应的打包后的资源；</li> <li>并且这个时候，我们其中的bundle.js通过 http://localhost:8080/bundle.js也是无法访问的：
<ul><li>所以必须将output.publicPath也设置为 /abc；</li> <li>官方其实有提到，建议devServer.publicPath 与output.publicPath相同；</li></ul></li></ul></li></ul></li> <li><p>devServer的contentBase</p> <ul><li>devServer中contentBase对于我们直接访问打包后的资源其实并没有太大的作用，它的主要作用是如果我们打包后的资源，又依赖于其他的一些资源，那么就需要指定从哪里来查找这个内容：
<ul><li>比如在index.html中，我们需要依赖一个 abc.js 文件，这个文件我们存放在 public文件 中；</li> <li>在index.html中，我们应该如何去引入这个文件呢？
<ul><li>比如代码是这样的：<code>&lt;script src=&quot;./public/abc.js&quot;&gt;&lt;/script&gt;</code>；</li> <li>但是这样打包后浏览器是无法通过相对路径去找到这个文件夹的；</li> <li>所以代码是这样的：<code>&lt;script src=&quot;/abc.js&quot;&gt;&lt;/script&gt;</code>;</li> <li>但是我们如何让它去查找到这个文件的存在呢？ 设置contentBase即可；</li></ul></li> <li>当然在devServer中还有一个可以监听contentBase发生变化后重新编译的一个属性：watchContentBase。</li></ul></li></ul></li> <li><p>devServer的hotOnly、host配置</p> <ul><li>hotOnly是当代码编译失败时，是否刷新整个页面：
<ul><li>默认情况下当代码编译失败修复后，我们会重新刷新整个页面；</li> <li>如果不希望重新刷新整个页面，可以设置hotOnly为true；</li></ul></li> <li>host设置主机地址：
<ul><li>默认值是localhost；</li> <li>如果希望其他地方也可以访问，可以设置为 0.0.0.0；</li> <li>localhost 和 0.0.0.0 的区别：
<ul><li>localhost：本质上是一个域名，通常情况下会被解析成127.0.0.1;</li> <li>127.0.0.1：回环地址(Loop Back Address)，表达的意思其实是我们主机自己发出去的包，直接被自己接收;
<ul><li>正常的数据库包经常 应用层 - 传输层 - 网络层 - 数据链路层 - 物理层 ;</li> <li>而回环地址，是在网络层直接就被获取到了，是不会经常数据链路层和物理层的;</li> <li>比如我们监听 127.0.0.1时，在同一个网段下的主机中，通过ip地址是不能访问的;</li></ul></li> <li>0.0.0.0：监听IPV4上所有的地址，再根据端口找到不同的应用程序;
<ul><li>比如我们监听 0.0.0.0时，在同一个网段下的主机中，通过ip地址是可以访问的;</li></ul></li></ul></li></ul></li></ul></li> <li><p>devServer的port、open、compress</p> <ul><li>port设置监听的端口，默认情况下是8080</li> <li>open是否打开浏览器：
<ul><li>默认值是false，设置为true会打开浏览器；</li> <li>也可以设置为类似于Google Chrome等值；</li></ul></li> <li>compress是否为静态文件开启gzip compression：
<ul><li>默认值是false，可以设置为true；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031161737.png" alt=""></li></ul></li></ul></li> <li><p>devServer的Proxy代理</p> <ul><li>proxy是我们开发中非常常用的一个配置选项，它的目的设置代理来解决跨域访问的问题：
<ul><li>比如我们的一个api请求是 http://localhost:8888，但是本地启动服务器的域名是 http://localhost:8000，这个时候发送网络请求就会出现跨域的问题；</li> <li>那么我们可以将请求先发送到一个代理服务器，代理服务器和API服务器没有跨域的问题，就可以解决我们的跨域问题了；</li></ul></li> <li>我们可以进行如下的设置：
<ul><li>target：表示的是代理到的目标地址，比如 /api-hy/moment会被代理到 http://localhost:8888/api-hymoment；</li> <li>pathRewrite：默认情况下，我们的 /api-hy 也会被写入到URL中，如果希望删除，可以使用pathRewrite；</li> <li>secure：默认情况下不接收转发到https的服务器上，如果希望支持，可以设置为false；</li> <li>changeOrigin：它表示是否更新代理后请求的headers中host地址；
<ul><li>changeOrigin的解析
<ul><li>这个 changeOrigin官方说的非常模糊，通过查看源码我发现其实是要修改代理请求中的headers中的host性：
<ul><li>因为我们真实的请求，其实是需要通过 http://localhost:8888来请求的；</li> <li>但是因为使用了代码，默认情况下它的值时 http://localhost:8000；</li> <li>如果我们需要修改，那么可以将changeOrigin设置为true即可；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031162044.png" alt=""></li></ul></li></ul></li></ul></li></ul></li></ul></li> <li><p>devServer的historyApiFallback</p> <ul><li>historyApiFallback是开发中一个非常常见的属性，它主要的作用是解决SPA页面在路由跳转之后，进行页面刷新时，返回404的错误。</li> <li>boolean值：默认是false
<ul><li>如果设置为true，那么在刷新时，返回404错误时，会自动返回index.html 的内容；</li></ul></li> <li>object类型的值，可以配置rewrites属性：
<ul><li>可以配置from来匹配路径，决定要跳转到哪一个页面；</li></ul></li> <li>事实上devServer中实现historyApiFallback功能是通过connect-history-api-fallback库的</li></ul></li> <li><p>devServer的resolve模块解析</p> <ul><li>resolve用于设置模块如何被解析：
<ul><li>在开发中我们会有各种各样的模块依赖，这些模块可能来自于自己编写的代码，也可能来自第三方库；</li> <li>resolve可以帮助webpack从每个 require/import 语句中，找到需要引入到合适的模块代码；</li> <li>webpack 使用 enhanced-resolve 来解析文件路径；</li></ul></li> <li>webpack能解析三种文件路径：
<ul><li>绝对路径
<ul><li>由于已经获得文件的绝对路径，因此不需要再做进一步解析。</li></ul></li> <li>相对路径
<ul><li>在这种情况下，使用 import 或 require 的资源文件所处的目录，被认为是上下文目录；</li> <li>在 import/require 中给定的相对路径，会拼接此上下文路径，来生成模块的绝对路径；</li></ul></li> <li>模块路径
<ul><li>在 resolve.modules中指定的所有目录检索模块；
<ul><li>默认值是 ['node_modules']，所以默认会从node_modules中查找文件；</li></ul></li> <li>我们可以通过设置别名的方式来替换初识模块路径，具体后面讲解alias的配置；</li></ul></li></ul></li> <li>确实是文件还是文件夹
<ul><li>如果是一个文件：
<ul><li>如果文件具有扩展名，则直接打包文件；</li> <li>否则，将使用 resolve.extensions选项作为文件扩展名解析；</li></ul></li> <li>如果是一个文件夹：
<ul><li>会在文件夹中根据resolve.mainFiles配置选项中指定的文件顺序查找；
<ul><li>resolve.mainFiles的默认值是 ['index']；</li> <li>再根据resolve.extensions来解析扩展名；</li></ul></li></ul></li></ul></li> <li>extensions和alias配置
<ul><li>extensions是解析到文件时自动添加扩展名：
<ul><li>默认值是 ['.wasm','.mjs','.js','.json']；</li> <li>所以如果我们代码中想要添加加载 .vue 或者 jsx 或者 ts 等文件时，我们必须自己写上扩展名；</li></ul></li> <li>另一个非常好用的功能是配置别名alias：
<ul><li>特别是当我们项目的目录结构比较深的时候，或者一个文件的路径可能需要 ../../../这种路径片段；</li> <li>我们可以给某些常见的路径起一个别名；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031163511.png" alt=""></li></ul></li></ul></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// watch: true,</span>
  mode<span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">&quot;bundle.js&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// 打包后的文件的输出目录</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./build&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 在打包之后的静态资源前面进行一个路径的拼接</span>
    <span class="token comment">// js/bundle -&gt; ./js/bundle.js</span>
    <span class="token comment">// publicPath: &quot;/abc&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 专门为webpack-dev-server</span>
  <span class="token comment">// devServer为开发过程中, 开启一个本地服务</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    hotOnly<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// host: &quot;0.0.0.0&quot;,</span>
    <span class="token comment">// port: 7777,</span>
    <span class="token comment">// open: true,</span>
    compress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    contentBase<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./why&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    watchContentBase<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// publicPath: &quot;/abc&quot;,</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// &quot;/why&quot;: &quot;http://localhost:8888&quot;</span>
      <span class="token string">&quot;/why&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">&quot;http://localhost:8888&quot;</span><span class="token punctuation">,</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;^/why&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        secure<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// historyApiFallback: true</span>
    historyApiFallback<span class="token operator">:</span> <span class="token punctuation">{</span>
      rewrites<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>from<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">abc</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> to<span class="token operator">:</span> <span class="token string">&quot;/index.html&quot;</span><span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.wasm'</span><span class="token punctuation">,</span> <span class="token string">'.mjs'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.json'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.vue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;@&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">&quot;pages&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src/pages&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><h4 id="webpack-dev-middleware"><a href="#webpack-dev-middleware" class="header-anchor">#</a> webpack-dev-middleware</h4> <ul><li>默认情况下，webpack-dev-server已经帮助我们做好了一切
<ul><li>比如通过express启动一个服务，比如HMR（热模块替换）；</li> <li>如果我们想要有更好的自由度，可以使用webpack-dev-middleware；</li></ul></li> <li>webpack-dev-middleware 是一个封装器(wrapper)，它可以把webpack 处理过的文件发送到一个 server。
<ul><li>webpack-dev-server 在内部使用了它，然而它也可以作为一个单独的 package 来使用，以便根据需求进行更多自定义设置；</li> <li>我们可以搭配一个服务器来使用它，比如express；<code>npm install --save-dev express webpack-dev-middleware</code> <img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031105804.png" alt=""></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// server.js</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackDevMiddleware <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-dev-middleware'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.config&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 传入配置信息, webpack根据配置信息进行编译</span>
<span class="token keyword">const</span> compiler <span class="token operator">=</span>  <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> middleware <span class="token operator">=</span> <span class="token function">webpackDevMiddleware</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>middleware<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;服务已经开启在3000端口上~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="output-配置"><a href="#output-配置" class="header-anchor">#</a> Output 配置</h3> <ul><li>Output 配置
<ul><li>Output中有两个很重要的属性：path和publicPath
<ul><li>path：用于指定文件的输出路径（比如打包的html、css、js等），是一个绝对路径；</li> <li>publicPath：默认是一个空字符串，它为我们项目中的资源指定一个公共的路径（publicPath）；</li></ul></li> <li>这个publicPath很不容易理解，其实就是给我们打包的资源，给它一个路径：
<ul><li>它的默认值是一个空字符串，所以我们打包后引入js文件时，路径是 bundle.js；</li> <li>在开发中，我们也将其设置为 /，路径是 /bundle.js，那么浏览器会根据所在的域名+路径去请求对应的资源</li> <li>如果我们希望在本地直接打开html文件来运行，会将其设置为 ./，路径时 ./bundle.js，可以根据相对路径去查找资源；</li> <li><code>资源的路径 = output.publicPath + 打包资源的路径（比如&quot;js/[name].bundle.js&quot;）</code></li></ul></li> <li>比较常设置的是两个值：
<ul><li><code>./</code>：本地环境下可以使用这个相对路径，本地直接打开<code>index.html</code>；</li> <li><code>/</code>：服务器部署时使用，服务器地址+ <code>/js/[name].bundle.js</code>；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031152339.png" alt=""></li></ul></li></ul></li></ul> <h3 id="hmr-模块热替换"><a href="#hmr-模块热替换" class="header-anchor">#</a> HMR（模块热替换）</h3> <h4 id="认识模块热替换-hmr"><a href="#认识模块热替换-hmr" class="header-anchor">#</a> 认识模块热替换（HMR）</h4> <ul><li>什么是HMR呢？
<ul><li>HMR的全称是Hot Module Replacement，翻译为模块热替换；</li> <li>模块热替换是指在 应用程序运行过程中，替换、添加、删除模块，而无需重新刷新整个页面；</li></ul></li> <li>HMR通过如下几种方式，来提高开发的速度：
<ul><li>不重新加载整个页面，这样可以保留某些应用程序的状态不丢失；</li> <li>只更新需要变化的内容，节省开发的时间；</li> <li>修改了css、js源代码，会立即在浏览器更新，相当于直接在浏览器的devtools中直接修改样式；</li></ul></li> <li>如何使用HMR呢？
<ul><li>默认情况下，webpack-dev-server已经支持HMR，我们只需要开启即可；</li> <li>在不开启HMR的情况下，当我们修改了源代码之后，整个页面会自动刷新，使用的是live reloading；</li></ul></li></ul> <h4 id="开启hmr"><a href="#开启hmr" class="header-anchor">#</a> 开启HMR</h4> <ul><li>修改webpack的配置：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
devServer<span class="token operator">:</span><span class="token punctuation">{</span>
    hot<span class="token operator">:</span><span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>浏览器可以看到如下效果：
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031142940.png" alt=""></li> <li>但是你会发现，当我们修改了某一个模块的代码时，依然是刷新的整个页面：
<ul><li>这是因为我们需要去指定哪些模块发生更新时，进行HMR；</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span><span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&quot;./utile.js&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;util更新了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="框架的hmr"><a href="#框架的hmr" class="header-anchor">#</a> 框架的HMR</h4> <ul><li>在开发其他项目时，我们是否需要经常手动去写入 module.hot.accpet相关的API呢？
<ul><li>比如开发Vue、React项目，我们修改了组件，希望进行热更新，这个时候应该如何去操作呢？</li> <li>事实上社区已经针对这些有很成熟的解决方案了：</li> <li>比如vue开发中，我们使用vue-loader，此loader支持vue组件的HMR，提供开箱即用的体验；</li> <li>比如react开发中，有React Hot Loader，实时调整react组件（目前React官方已经弃用了，改成使用react-refresh）；</li></ul></li> <li>React的HMR
<ul><li>React是借助于React Hot Loader来实现的HMR，目前已经改成使用react-refresh来实现了。</li> <li>安装实现HMR相关的依赖：
<ul><li><code>npm install -D @pmmmwh/react-refresh-webpack-plugin react-refresh</code></li></ul></li> <li>修改webpack.config.js和babel.config.js文件：
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031144549.png" alt=""></li></ul></li></ul></li> <li>Vue的HMR
<ul><li>Vue的加载我们需要使用vue-loader，而vue-loader加载的组件默认会帮助我们进行HMR的处理。</li> <li>安装加载vue所需要的依赖：<code>npm install vue-loader vue-template-compiler -D</code></li> <li>配置webpack.config.js：
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031144656.png" alt=""></li></ul></li></ul></li></ul> <h4 id="hmr的原理"><a href="#hmr的原理" class="header-anchor">#</a> HMR的原理</h4> <ul><li>那么HMR的原理是什么呢？如何可以做到只更新一个模块中的内容呢？
<ul><li>webpack-dev-server会创建两个服务：提供静态资源的服务（express）和Socket服务（net.Socket）；</li> <li>express server负责直接提供静态资源的服务（打包后的资源直接被浏览器请求和解析）；</li></ul></li> <li>HMR Socket Server，是一个socket的长连接：
<ul><li>长连接有一个最好的好处是建立连接后双方可以通信（服务器可以直接发送文件到客户端）；</li> <li>当服务器监听到对应的模块发生变化时，会生成两个文件.json（manifest文件）和.js文件（update chunk）</li> <li>通过长连接，可以直接将这两个文件主动发送给客户端（浏览器）；</li> <li>浏览器拿到两个新的文件后，通过HMR runtime机制，加载这两个文件，并且针对修改的模块进行更新；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031145143.png" alt=""></li></ul></li></ul> <h3 id="环境分离"><a href="#环境分离" class="header-anchor">#</a> 环境分离</h3> <h4 id="如何区分开发环境"><a href="#如何区分开发环境" class="header-anchor">#</a> 如何区分开发环境</h4> <ul><li>目前我们所有的webpack配置信息都是放到一个配置文件中的：webpack.config.js
<ul><li>当配置越来越多时，这个文件会变得越来越不容易维护；</li> <li>并且某些配置是在开发环境需要使用的，某些配置是在生成环境需要使用的，当然某些配置是在开发和生成环境都会使用的；</li> <li>所以，我们最好对配置进行划分，方便我们维护和管理；</li></ul></li> <li>那么，在启动时如何可以区分不同的配置呢？
<ul><li>方案一：编写两个不同的配置文件，开发和生成时，分别加载不同的配置文件即可；</li> <li>方式二：使用相同的一个入口配置文件，通过设置参数来区分它们；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031165332.png" alt=""></li></ul></li></ul> <h4 id="入口文件解析"><a href="#入口文件解析" class="header-anchor">#</a> 入口文件解析</h4> <ul><li>我们之前编写入口文件的规则是这样的：./src/index.js，但是如果我们的配置文件所在的位置变成了 config 目录，我们是否应该变成 ../src/index.js呢？
<ul><li>如果我们这样编写，会发现是报错的，依然要写成 ./src/index.js；</li> <li>这是因为入口文件其实是和另一个属性时有关的 context；</li></ul></li> <li>context的作用是用于解析入口（entry point）和加载器（loader）：
<ul><li>官方说法：默认是当前路径（但是经过我测试，默认应该是webpack的启动目录）</li> <li>另外推荐在配置中传入一个值；
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211031165658.png" alt=""></li></ul></li></ul> <h4 id="配置文件的分离"><a href="#配置文件的分离" class="header-anchor">#</a> 配置文件的分离</h4> <ul><li>这里我们创建三个文件：
<ul><li>webpack.comm.conf.js</li> <li>webpack.dev.conf.js</li> <li>webpack.prod.conf.js
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103111249.png" alt=""></li></ul></li></ul> <h4 id="认识代码分离"><a href="#认识代码分离" class="header-anchor">#</a> 认识代码分离</h4> <ul><li>代码分离（Code Splitting）是webpack一个非常重要的特性：
<ul><li>它主要的目的是将代码分离到不同的bundle中，之后我们可以按需加载，或者并行加载这些文件；</li> <li>比如默认情况下，所有的JavaScript代码（业务代码、第三方依赖、暂时没有用到的模块）在首页全部都加载，就会影响首页的加载速度；</li> <li>代码分离可以分出出更小的bundle，以及控制资源加载优先级，提供代码的加载性能；</li> <li>只要是异步导入的代码，webpack都会进行代码分离</li></ul></li> <li>webpack中常用的代码分离有三种：
<ul><li>入口起点：使用entry配置手动分离代码；
<ul><li>入口起点的含义非常简单，就是配置多入口：
<ul><li>比如配置一个index.js和main.js的入口；</li> <li>他们分别有自己的代码逻辑；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103120714.png" alt=""></li></ul></li></ul></li> <li>防止重复：使用Entry Dependencies或者SplitChunksPlugin去重和分离代码；
<ul><li>假如我们的index.js和main.js都依赖两个库：lodash、dayjs
<ul><li>如果我们单纯的进行入口分离，那么打包后的两个bunlde都有会有一份lodash和dayjs；</li> <li>事实上我们可以对他们进行共享；
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103121033.png" alt=""></li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103121523.png" alt=""></li></ul></li></ul></li> <li>另外一种分包的模式是splitChunk，它是使用SplitChunksPlugin来实现的：
<ul><li>因为该插件webpack已经默认安装和集成，所以我们并不需要单独安装和直接使用该插件；</li> <li>只需要提供SplitChunksPlugin相关的配置信息即可；</li> <li>Webpack提供了SplitChunksPlugin默认的配置，我们也可以手动来修改它的配置：
<ul><li>比如默认配置中，chunks仅仅针对于异步（async）请求，我们可以设置为initial或者all；</li></ul></li> <li>SplitChunks自定义配置解析
<ul><li>Chunks:
<ul><li>默认值是async</li> <li>另一个值是initial，表示对通过的代码进行处理</li> <li>all表示对同步和异步代码都进行处理</li></ul></li> <li>minSize
<ul><li>拆分包的大小, 至少为minSize；</li> <li>如果一个包拆分出来达不到minSize,那么这个包就不会拆分；</li></ul></li> <li>maxSize
<ul><li>将大于maxSize的包，拆分为不小于minSize的包；</li></ul></li> <li>minChunks
<ul><li>至少被引入的次数，默认是1；</li> <li>如果我们写一个2，但是引入了一次，那么不会被单独拆分；</li></ul></li> <li>name：设置拆包的名称
<ul><li>可以设置一个名称，也可以设置为false；</li> <li>设置为false后，需要在cacheGroups中设置名称；</li></ul></li> <li>cacheGroups
<ul><li>用于对拆分的包就行分组，比如一个lodash在拆分之后，并不会立即打包，而是会等到有没有其他符合规包-起来打包；</li> <li>test属性：匹配符合规则的包；</li> <li>name属性：拆分包的name属性；</li> <li>filename属性：拆分包的名称，可以自己使用placeholder属性；</li></ul></li> <li>chunkIds
<ul><li>optimization.chunkIds配置用于告知webpack模块的id采用什么算法生成。</li> <li>在 output 输出的时候 <code>filename: &quot;[name].bundle.js&quot;</code> 也相关,</li> <li>有三个比较常见的值：
<ul><li>natural：按照数字的顺序使用id；</li> <li>named：development下的默认值，一个可读的名称的id；</li> <li>deterministic：确定性的，在不同的编译中不变的短数字id
<ul><li>在webpack4中是没有这个值的；</li> <li>那个时候如果使用natural，那么在一些编译发生变化时，就会有问题；</li></ul></li></ul></li> <li>最佳实践：
<ul><li>开发过程中，我们推荐使用named；</li> <li>打包过程中，我们推荐使用deterministic；</li></ul></li></ul></li> <li>runtimeChunk
<ul><li>配置runtime相关的代码是否抽取到一个单独的chunk中：
<ul><li>runtime相关的代码指的是在运行环境中，对模块进行解析、加载、模块信息相关的代码；</li> <li>比如我们的component、bar两个通过import函数相关的代码加载，就是通过runtime代码完成的；</li></ul></li> <li>抽离出来后，有利于浏览器缓存的策略：
<ul><li>比如我们修改了业务代码（main），那么runtime和component、bar的chunk是不需要重新加载的；</li> <li>比如我们修改了component、bar的代码，那么main中的代码是不需要重新加载的；</li></ul></li> <li>设置的值：
<ul><li>true/multiple：针对每个入口打包一个runtime文件；</li> <li>single：打包一个runtime文件；</li> <li>对象：name属性决定runtimeChunk的名称；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103134003.png" alt=""> <img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103121329.png" alt=""></li></ul></li></ul></li></ul></li></ul></li></ul></li> <li>动态导入：通过模块的内联函数调用来分离代码；
<ul><li>另外一个代码拆分的方式是动态导入时，webpack提供了两种实现动态导入的方式：
<ul><li>第一种，使用ECMAScript中的 import()语法来完成，也是目前推荐的方式；</li> <li>第二种，使用webpack遗留的 require.ensure，目前已经不推荐使用；</li></ul></li> <li>比如我们有一个模块 bar.js：
<ul><li>该模块我们希望在代码运行过程中来加载它（比如判断一个条件成立时加载）；</li> <li>因为我们并不确定这个模块中的代码一定会用到，所以最好拆分成一个独立的js文件；</li> <li>这样可以保证不用到该内容时，浏览器不需要加载和处理该文件的js代码；</li> <li>这个时候我们就可以使用动态导入；</li></ul></li> <li>注意：使用动态导入bar.js：
<ul><li>在webpack中，通过动态导入获取到一个对象；</li> <li>真正导出的内容，在改对象的default属性中，所以我们需要做一个简单的解构；</li></ul></li> <li>动态导入的文件命名
<ul><li>因为动态导入通常是一定会打包成独立的文件的，所以并不会再cacheGroups中进行配置；</li> <li>那么它的命名我们通常会在output中，通过 chunkFilename 属性来命名；
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103123555.png" alt=""></li></ul></li> <li>但是，你会发现默认情况下我们获取到的 [name]是和id的名称保持一致的
<ul><li>如果我们希望修改name的值，可以通过magic comments（魔法注释）的方式；
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103123706.png" alt=""></li></ul></li></ul></li> <li>代码的懒加载
<ul><li>动态import使用最多的一个场景是懒加载（比如路由懒加载）：
<ul><li>封装一个component.js，返回一个component对象；</li> <li>我们可以在一个按钮点击时，加载这个对象；
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103124249.png" alt=""></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul> <h4 id="prefetch和preload"><a href="#prefetch和preload" class="header-anchor">#</a> Prefetch和Preload</h4> <ul><li>webpack v4.6.0+增加了对预获取和预加载的支持。</li> <li>在声明import 时，使用下面这些内置指令，来告知浏览器：
<ul><li>prefetch(预获取)：将来某些导航下可能需要的资源</li> <li>preload(预加载)：当前导航下可能需要资源
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211103134243.png" alt=""></li></ul></li> <li>与prefetch 指令相比，preload 指令有许多不同之处：
<ul><li>preload chunk 会在父chunk 加载时，以并行方式开始加载。prefetch chunk 会在父chunk 加载结束后开始加载。</li> <li>preload chunk 具有中等优先级，并立即下载。prefetch chunk 在浏览器闲置时下载。</li> <li>preload chunk 会在父chunk 中立即请求，用于当下时刻。prefetch chunk 会用于未来的某个时刻。</li></ul></li></ul></li></ul> <h3 id="cdn"><a href="#cdn" class="header-anchor">#</a> CDN</h3> <h4 id="什么是cdn"><a href="#什么是cdn" class="header-anchor">#</a> 什么是CDN？</h4> <ul><li>CDN称之为内容分发网络（Content Delivery Network或Content Distribution Network，缩写：CDN）
<ul><li>它是指通过相互连接的网络系统，利用最靠近每个用户的服务器；</li> <li>更快、更可靠地将音乐、图片、视频、应用程序及其他文件发送给用户；</li> <li>来提供高性能、可扩展性及低成本的网络内容传递给用户；</li></ul></li> <li>在开发中，我们使用CDN主要是两种方式：
<ul><li>方式一：打包的所有静态资源，放到CDN服务器，用户所有资源都是通过CDN服务器加载的；</li> <li>方式二：一些第三方资源放到CDN服务器上；</li></ul></li></ul> <h4 id="购买cdn服务器"><a href="#购买cdn服务器" class="header-anchor">#</a> 购买CDN服务器</h4> <ul><li>如果所有的静态资源都想要放到CDN服务器上，我们需要购买自己的CDN服务器；
<ul><li>目前阿里、腾讯、亚马逊、Google等都可以购买CDN服务器；</li> <li>我们可以直接修改publicPath，在打包时添加上自己的CDN地址；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211104170437.png" alt=""></li></ul></li></ul> <h4 id="第三方库的cdn服务器"><a href="#第三方库的cdn服务器" class="header-anchor">#</a> 第三方库的CDN服务器</h4> <ul><li>通常一些比较出名的开源框架都会将打包后的源码放到一些比较出名的、免费的CDN服务器上：
<ul><li>国际上使用比较多的是unpkg、JSDelivr、cdnjs；</li> <li>国内也有一个比较好用的CDN是bootcdn；</li></ul></li> <li>在项目中，我们如何去引入这些CDN呢？
<ul><li>第一，在打包的时候我们不再需要对类似于lodash或者dayjs这些库进行打包；</li> <li>第二，在html模块中，我们需要自己加入对应的CDN服务器地址；</li></ul></li> <li>第一步，我们可以通过webpack配置，来排除一些库的打包：</li> <li>第二步，在html模块中，加入CDN服务器地址：
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211104171138.png" alt=""></li> <li>手工在index.html模板代码中，需要引用的CDN的库
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211104172154.png" alt=""></li></ul></li></ul></li></ul> <h3 id="shimming"><a href="#shimming" class="header-anchor">#</a> shimming</h3> <h4 id="认识shimming"><a href="#认识shimming" class="header-anchor">#</a> 认识shimming</h4> <ul><li>shimming是一个概念，是某一类功能的统称：
<ul><li>shimming翻译过来我们称之为 垫片，相当于给我们的代码填充一些垫片来处理一些问题；</li> <li>比如我们现在依赖一个第三方的库，这个第三方的库本身依赖lodash，但是默认没有对lodash进行导入（认为全局存在lodash），那么我们就可以通过ProvidePlugin来实现shimming的效果；</li></ul></li> <li>注意：webpack并不推荐随意的使用shimming
<ul><li>Webpack背后的整个理念是使前端开发更加模块化；</li> <li>也就是说，需要编写具有封闭性的、不存在隐含依赖（比如全局变量）的彼此隔离的模块；</li></ul></li></ul> <h4 id="shimming预支全局变量"><a href="#shimming预支全局变量" class="header-anchor">#</a> Shimming预支全局变量</h4> <ul><li>目前我们的lodash、dayjs都使用了CDN进行引入，所以相当于在全局是可以使用_和dayjs的
<ul><li>假如一个文件中我们使用了axios，但是没有对它进行引入，那么下面的代码是会报错的；</li></ul></li> <li>我们可以通过使用ProvidePlugin来实现shimming的效果：
<ul><li>ProvidePlugin能够帮助我们在每个模块中，通过一个变量来获取一个package；</li> <li>如果webpack看到这个模块，它将在最终的bundle中引入这个模块；</li> <li>另外ProvidePlugin是webpack默认的一个插件，所以不需要专门导入；</li> <li><img src="media/16360204530486.jpg" alt=""></li></ul></li></ul> <h3 id="tree-shaking"><a href="#tree-shaking" class="header-anchor">#</a> Tree Shaking</h3> <h4 id="什么是tree-shaking"><a href="#什么是tree-shaking" class="header-anchor">#</a> 什么是Tree Shaking</h4> <ul><li>什么是Tree Shaking呢？
<ul><li>Tree Shaking是一个术语，在计算机中表示消除死代码（dead_code）；</li> <li>最早的想法起源于LISP，用于消除未调用的代码（纯函数无副作用，可以放心的消除，这也是为什么要求我们在进行函数式编程时，尽量使用纯函数的原因之一）；</li> <li>后来Tree Shaking也被应用于其他的语言，比如JavaScript、Dart；</li></ul></li> <li>JavaScript的Tree Shaking：
<ul><li>对JavaScript进行Tree Shaking是源自打包工具rollup；</li> <li>这是因为Tree Shaking依赖于ES Module的静态语法分析（不执行任何的代码，可以明确知道模块的依赖关系）</li> <li>webpack2正式内置支持了ES2015模块，和检测未使用模块的能力；</li> <li>在webpack4正式扩展了这个能力，并且通过 package.json的 sideEffects属性作为标记，告知webpack在编译时，哪里文件可以安全的删除掉；</li> <li>webpack5中，也提供了对部分CommonJS的tree shaking的支持；
<ul><li>https://github.com/webpack/changelog-v5#commonis-tree-shaking</li></ul></li></ul></li></ul> <h4 id="webpack实现tree-shaking"><a href="#webpack实现tree-shaking" class="header-anchor">#</a> webpack实现Tree Shaking</h4> <ul><li>事实上webpack实现Tree Shaking采用了两种不同的方案：
<ul><li>usedExports：通过标记某些函数是否被使用，之后通过Terser来进行优化的；
<ul><li>将mode设置为development模式：
<ul><li>为了可以看到 usedExports带来的效果，我们需要设置为 development 模式，production自动开启</li> <li>因为在 production 模式下，webpack默认的一些优化会带来很大额影响。</li></ul></li> <li>设置usedExports为true和false对比打包后的代码：
<ul><li>在usedExports设置为true时，会有一段注释：unused harmony export mul；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107155816.png" alt=""></li> <li>这段注释的意义是什么呢？告知Terser在优化时，可以删除掉这段代码；</li></ul></li> <li>这个时候，我们讲 minimize设置true：
<ul><li>usedExports设置为false时，mul函数没有被移除掉；</li> <li>usedExports设置为true时，mul函数有被移除掉；</li></ul></li> <li>所以，usedExports实现Tree Shaking是结合Terser来完成的。</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107160122.png" alt=""></li></ul></li> <li>sideEffects：跳过整个模块/文件，直接查看该文件是否有副作用；
<ul><li>sideEffects用于告知webpack compiler哪些模块时有副作用的：
<ul><li>副作用的意思是这里面的代码有执行一些特殊的任务，不能仅仅通过export来判断这段代码的意义；</li> <li>副作用的问题，在讲React的纯函数时是有讲过的；</li></ul></li> <li>在package.json中设置sideEffects的值：
<ul><li>如果我们将sideEffects设置为false，就是告知webpack可以安全的删除未用到的exports；</li> <li>如果有一些我们希望保留，可以设置为数组；</li></ul></li> <li>比如我们有一个format.js、style.css文件：
<ul><li>该文件在导入时没有使用任何的变量来接受；</li> <li>那么打包后的文件，不会保留format.js、style.css相关的任何代码；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107161053.png" alt=""></li></ul></li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107160712.png" alt=""></li></ul></li></ul></li></ul> <h4 id="webpack中treeshaking的设置"><a href="#webpack中treeshaking的设置" class="header-anchor">#</a> Webpack中treeshaking的设置</h4> <ul><li>所以，如何在项目中对JavaScript的代码进行TreeShaking呢（生成环境）？
<ul><li>在optimization中配置usedExports为true，来帮助Terser进行优化；</li> <li>在package.json中配置sideEffects，直接对模块进行优化；</li></ul></li></ul> <h4 id="css实现tree-shaking"><a href="#css实现tree-shaking" class="header-anchor">#</a> CSS实现Tree Shaking</h4> <ul><li>上面我们学习的都是关于JavaScript的Tree Shaking，那么CSS是否也可以进行Tree Shaking操作呢？
<ul><li>CSS的Tree Shaking需要借助于一些其他的插件；
<ul><li>在早期的时候，我们会使用PurifyCss插件来完成CSS的tree shaking，但是目前该库已经不再维护了（最新更新也是在4年前了）；
<ul><li>目前我们可以使用另外一个库来完成CSS的Tree Shaking：PurgeCSS，也是一个帮助我们删除未使用的CSS的工具；</li> <li>安装PurgeCss的webpack插件：<code>npm install purgecss-webpack-plugin -D</code></li></ul></li> <li>配置PurgeCss
<ul><li>配置这个插件（生成环境）：
<ul><li>paths：表示要检测哪些目录下的内容需要被分析，这里我们可以使用glob；</li> <li>默认情况下，Purgecss会将我们的html标签的样式移除掉，如果我们希望保留，可以添加一个safelist的属性；</li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107162056.png" alt=""></li> <li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107162230.png" alt=""></li></ul></li> <li>purgecss也可以对less文件进行处理（所以它是对打包后的css进行tree shaking操作）；</li></ul></li></ul></li></ul></li></ul> <h3 id="http压缩"><a href="#http压缩" class="header-anchor">#</a> HTTP压缩</h3> <h4 id="什么是http压缩"><a href="#什么是http压缩" class="header-anchor">#</a> 什么是HTTP压缩？</h4> <ul><li>HTTP压缩是一种内置在 服务器和 客户端之间的，以改进传输速度和带宽利用率的方式；
<ul><li>HTTP压缩的流程什么呢？
<ul><li>第一步：HTTP数据在服务器发送前就已经被压缩了；（可以在webpack中完成）</li> <li>第二步：兼容的浏览器在向服务器发送请求时，会告知服务器自己支持哪些压缩格式；
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107165302.png" alt=""></li></ul></li> <li>第三步：服务器在浏览器支持的压缩格式下，直接返回对应的压缩后的文件，并且在响应头中告知浏览器；
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107165319.png" alt=""></li></ul></li></ul></li></ul></li></ul> <h4 id="目前的压缩格式"><a href="#目前的压缩格式" class="header-anchor">#</a> 目前的压缩格式</h4> <ul><li>目前的压缩格式非常的多：
<ul><li>compress –UNIX的“compress”程序的方法（历史性原因，不推荐大多数应用使用，应该使用gzip或deflate）；</li> <li>deflate –基于deflate算法（定义于RFC 1951）的压缩，使用zlib数据格式封装；</li> <li>gzip –GNU zip格式（定义于RFC 1952），是目前使用比较广泛的压缩算法；</li> <li>br –一种新的开源压缩算法，专为HTTP内容的编码而设计；</li></ul></li></ul> <h4 id="webpack对文件压缩"><a href="#webpack对文件压缩" class="header-anchor">#</a> Webpack对文件压缩</h4> <ul><li>webpack中相当于是实现了HTTP压缩的第一步操作，我们可以使用CompressionPlugin。</li> <li>第一步，安装CompressionPlugin：<code>npm install compression-webpack-plugin -D</code></li> <li>第二步，使用CompressionPlugin即可
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107170010.png" alt=""></li></ul> <h4 id="html文件中代码的压缩"><a href="#html文件中代码的压缩" class="header-anchor">#</a> HTML文件中代码的压缩</h4> <ul><li>我们之前使用了HtmlWebpackPlugin插件来生成HTML的模板，事实上它还有一些其他的配置：</li> <li>inject：设置打包的资源插入的位置
<ul><li>true、false 、body、head</li></ul></li> <li>cache：设置为true，只有当文件改变时，才会生成新的文件（默认值也是true）</li> <li>minify：默认会使用一个插件html-minifier-terser
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107170238.png" alt=""></li></ul> <h4 id="inlinechunkhtmlplugin"><a href="#inlinechunkhtmlplugin" class="header-anchor">#</a> InlineChunkHtmlPlugin</h4> <ul><li>另外有一个插件，可以辅助将一些chunk出来的模块，内联到html中：
- 比如runtime的代码，代码量不大，但是是必须加载的；
- 那么我们可以直接内联到html中；
<ul><li>这个插件是在react-dev-utils中实现的，所以我们可以安装一下它：<code>npm install react-dev-utils -D</code></li> <li>在production的plugins中进行配置：
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107170435.png" alt=""></li></ul></li></ul> <h3 id="封装library"><a href="#封装library" class="header-anchor">#</a> 封装Library</h3> <p>webpack可以帮助我们打包自己的库文件，比如我们需要打包一个coderwhy_utils的一个库。
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107170737.png" alt=""></p> <h4 id="打包library"><a href="#打包library" class="header-anchor">#</a> 打包Library</h4> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211107171007.png" alt="">
## Webpack打包</p> <h3 id="打包分析"><a href="#打包分析" class="header-anchor">#</a> 打包分析</h3> <h4 id="打包的时间分析"><a href="#打包的时间分析" class="header-anchor">#</a> 打包的时间分析</h4> <ul><li>如果我们希望看到每一个loader、每一个Plugin消耗的打包时间，可以借助于一个插件：speed-measure-webpack-plugin
<ul><li>注意：该插件在最新的webpack版本中存在一些兼容性的问题（和部分Plugin不兼容）</li> <li>暂时的做法是把不兼容的插件先删除掉，也就是不兼容的插件不显示它的打包时间就可以了；</li></ul></li> <li>第一步，安装speed-measure-webpack-plugin插件
<ul><li><code>npm install speed-measure-webpack-plugin -D</code></li></ul></li> <li>第二步，使用speed-measure-webpack-plugin插件
<ul><li>创建插件导出的对象SpeedMeasurePlugin；</li> <li>使用smp.wrap包裹我们导出的webpack配置；</li></ul></li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220141725.png" alt=""></p> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220141622.png" alt=""></p> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220141917.png" alt=""></p> <h4 id="打包后文件分析"><a href="#打包后文件分析" class="header-anchor">#</a> 打包后文件分析</h4> <ul><li>方案一：生成一个stats.json的文件
<ul><li><code>&quot;stats&quot; : &quot;webpack --config ./config/webpack.common.js --env production --profile --json=stats&quot;</code></li> <li>通过执行npm run build:status可以获取到一个stats.json的文件：
<ul><li>这个文件我们自己分析不容易看到其中的信息；</li> <li><code>可以放到 http://webpack.github.com/analyse，进行分析</code></li></ul></li></ul></li></ul> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220161228.png" alt=""></p> <ul><li>方案二：使用webpack-bundle-analyzer工具
<ul><li>直观查看包大小的工具是webpack-bundle-analyzer。</li> <li>第一步，我们可以直接安装这个工具：
<ul><li><code>npm install webpack-bundle-analyzer -D</code></li></ul></li> <li>第二步，我们可以在webpack配置中使用该插件：
<ul><li><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220164232.png" alt=""></li> <li>在打包webpack的时候，这个工具是帮助我们打开一个8888端口上的服务，我们可以直接的看到每个包的大小。
<ul><li>比如有一个包时通过一个Vue组件打包的，但是非常的大，那么我们可以考虑是否可以拆分出多个组件，并且对其进行懒加载；</li> <li>比如一个图片或者字体文件特别大，是否可以对其进行压缩或者其他的优化处理；</li></ul></li></ul></li></ul></li></ul> <h2 id="webpack的启动流程"><a href="#webpack的启动流程" class="header-anchor">#</a> Webpack的启动流程</h2> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220164955.png" alt=""></p> <h2 id="webpack源码阅读"><a href="#webpack源码阅读" class="header-anchor">#</a> Webpack源码阅读</h2> <h3 id="webpack源码流程"><a href="#webpack源码流程" class="header-anchor">#</a> Webpack源码流程</h3> <ul><li>第一步：下载webpack的源码
<ul><li>https://github.com/webpack/webpack</li></ul></li> <li>第二步：安装项目相关的依赖
<ul><li><code>npm install</code></li></ul></li> <li>第三步：编写自己的源代码</li> <li>第四步：编写webpack的配置文件
<ul><li>webpack.config.js</li></ul></li> <li>第五步：编写启动的文件build.js</li></ul> <h3 id="创建compiler"><a href="#创建compiler" class="header-anchor">#</a> 创建Compiler</h3> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220193202.png" alt=""></p> <h3 id="compiler中run方法执行的hook"><a href="#compiler中run方法执行的hook" class="header-anchor">#</a> Compiler中run方法执行的Hook</h3> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220193404.png" alt=""></p> <h3 id="compilation对module的处理"><a href="#compilation对module的处理" class="header-anchor">#</a> Compilation对Module的处理</h3> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220193812.png" alt=""></p> <h3 id="module的build阶段"><a href="#module的build阶段" class="header-anchor">#</a> module的build阶段</h3> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220194003.png" alt=""></p> <h3 id="输出asset阶段"><a href="#输出asset阶段" class="header-anchor">#</a> 输出asset阶段</h3> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220194050.png" alt=""></p> <h3 id="compiler和compilation的区别"><a href="#compiler和compilation的区别" class="header-anchor">#</a> Compiler和Compilation的区别</h3> <ul><li>Compiler和Compilation的区别
<ul><li><p>Compiler在webpack构建的之初就会创建的一个对象, 并且在webpack的整个生命周期都会存在(before - run - beforeCompiler - compile - make - finishMake - afterCompiler - done)</p></li> <li><p>只要是做webpack的编译, 都会先创建一个Compiler</p></li> <li><p>Compilation是到准备编译模块(比如main.js), 才会创建Compilation对象</p></li> <li><p>主要是存在于 compile（之后） - make（之后） 阶段主要使用的对象</p></li> <li><p>watch -&gt; 源代码发生改变就需要重新编译模块</p></li> <li><p>Compiler可以继续使用(如果我修改webpack的配置, 那么需要重新执行run run build)</p></li> <li><p>Compilation需要创建一个新的Compilation对象,修改源代码就会重新创建一个对象</p></li></ul></li></ul> <h3 id="plugin执行的顺序"><a href="#plugin执行的顺序" class="header-anchor">#</a> Plugin执行的顺序</h3> <p>在webpack声明周期任意阶段执行，取决于我们监听了那个hook，在执行了那个hook就开始执行。
<img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211220212630.png" alt=""></p> <h2 id="react脚手架分析"><a href="#react脚手架分析" class="header-anchor">#</a> React脚手架分析</h2> <h2 id="vue脚手架分析"><a href="#vue脚手架分析" class="header-anchor">#</a> Vue脚手架分析</h2> <h3 id="vue脚手架启动"><a href="#vue脚手架启动" class="header-anchor">#</a> Vue脚手架启动</h3> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211225093920.png" alt=""></p> <h3 id="vue脚手架加载配置"><a href="#vue脚手架加载配置" class="header-anchor">#</a> Vue脚手架加载配置</h3> <p><img src="https://output66.oss-cn-beijing.aliyuncs.com/img/20211225094031.png" alt=""></p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间: </span> <span class="time">16 days ago</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#全局需要的函数" class="sidebar-link reco-side-全局需要的函数" data-v-cb1513f6>全局需要的函数</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack初见" class="sidebar-link reco-side-webpack初见" data-v-cb1513f6>webpack初见</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#vue-cli-service-运行过程" class="sidebar-link reco-side-vue-cli-service-运行过程" data-v-cb1513f6>vue-cli-service 运行过程</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#前端开发的复杂化" class="sidebar-link reco-side-前端开发的复杂化" data-v-cb1513f6>前端开发的复杂化</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#前端是三大框架脚手架" class="sidebar-link reco-side-前端是三大框架脚手架" data-v-cb1513f6>前端是三大框架脚手架</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack是什么" class="sidebar-link reco-side-webpack是什么" data-v-cb1513f6>Webpack是什么？</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack安装" class="sidebar-link reco-side-webpack安装" data-v-cb1513f6>Webpack安装</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack配置" class="sidebar-link reco-side-webpack配置" data-v-cb1513f6>webpack配置</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack文件配置" class="sidebar-link reco-side-webpack文件配置" data-v-cb1513f6>webpack文件配置</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack依赖图-其实就是流程" class="sidebar-link reco-side-webpack依赖图-其实就是流程" data-v-cb1513f6>webpack依赖图（其实就是流程）</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#loader" class="sidebar-link reco-side-loader" data-v-cb1513f6>Loader</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#自定义loader" class="sidebar-link reco-side-自定义loader" data-v-cb1513f6>自定义Loader</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#plugin" class="sidebar-link reco-side-plugin" data-v-cb1513f6>Plugin</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#自定义plugin" class="sidebar-link reco-side-自定义plugin" data-v-cb1513f6>自定义Plugin</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#hook的使用过程" class="sidebar-link reco-side-hook的使用过程" data-v-cb1513f6>Hook的使用过程</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#asset-module-type" class="sidebar-link reco-side-asset-module-type" data-v-cb1513f6>asset  module  type</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#浏览器兼容性" class="sidebar-link reco-side-浏览器兼容性" data-v-cb1513f6>浏览器兼容性</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#hash、contenthash、chunkhash" class="sidebar-link reco-side-hash、contenthash、chunkhash" data-v-cb1513f6>Hash、ContentHash、ChunkHash</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#模块化原理" class="sidebar-link reco-side-模块化原理" data-v-cb1513f6>模块化原理</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#source-map" class="sidebar-link reco-side-source-map" data-v-cb1513f6>source-map</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#babel的深入解析" class="sidebar-link reco-side-babel的深入解析" data-v-cb1513f6>Babel的深入解析</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#eslint" class="sidebar-link reco-side-eslint" data-v-cb1513f6>ESLint</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack中配置vue加载" class="sidebar-link reco-side-webpack中配置vue加载" data-v-cb1513f6>Webpack中配置vue加载</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#为什么要搭建本地服务器" class="sidebar-link reco-side-为什么要搭建本地服务器" data-v-cb1513f6>为什么要搭建本地服务器?</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#output-配置" class="sidebar-link reco-side-output-配置" data-v-cb1513f6>Output 配置</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#hmr-模块热替换" class="sidebar-link reco-side-hmr-模块热替换" data-v-cb1513f6>HMR（模块热替换）</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#环境分离" class="sidebar-link reco-side-环境分离" data-v-cb1513f6>环境分离</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#cdn" class="sidebar-link reco-side-cdn" data-v-cb1513f6>CDN</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#shimming" class="sidebar-link reco-side-shimming" data-v-cb1513f6>shimming</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#tree-shaking" class="sidebar-link reco-side-tree-shaking" data-v-cb1513f6>Tree Shaking</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#http压缩" class="sidebar-link reco-side-http压缩" data-v-cb1513f6>HTTP压缩</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#封装library" class="sidebar-link reco-side-封装library" data-v-cb1513f6>封装Library</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#打包分析" class="sidebar-link reco-side-打包分析" data-v-cb1513f6>打包分析</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack的启动流程" class="sidebar-link reco-side-webpack的启动流程" data-v-cb1513f6>Webpack的启动流程</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack源码阅读" class="sidebar-link reco-side-webpack源码阅读" data-v-cb1513f6>Webpack源码阅读</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#webpack源码流程" class="sidebar-link reco-side-webpack源码流程" data-v-cb1513f6>Webpack源码流程</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#创建compiler" class="sidebar-link reco-side-创建compiler" data-v-cb1513f6>创建Compiler</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#compiler中run方法执行的hook" class="sidebar-link reco-side-compiler中run方法执行的hook" data-v-cb1513f6>Compiler中run方法执行的Hook</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#compilation对module的处理" class="sidebar-link reco-side-compilation对module的处理" data-v-cb1513f6>Compilation对Module的处理</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#module的build阶段" class="sidebar-link reco-side-module的build阶段" data-v-cb1513f6>module的build阶段</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#输出asset阶段" class="sidebar-link reco-side-输出asset阶段" data-v-cb1513f6>输出asset阶段</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#compiler和compilation的区别" class="sidebar-link reco-side-compiler和compilation的区别" data-v-cb1513f6>Compiler和Compilation的区别</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#plugin执行的顺序" class="sidebar-link reco-side-plugin执行的顺序" data-v-cb1513f6>Plugin执行的顺序</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#react脚手架分析" class="sidebar-link reco-side-react脚手架分析" data-v-cb1513f6>React脚手架分析</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#vue脚手架分析" class="sidebar-link reco-side-vue脚手架分析" data-v-cb1513f6>Vue脚手架分析</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#vue脚手架启动" class="sidebar-link reco-side-vue脚手架启动" data-v-cb1513f6>Vue脚手架启动</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/PackagingModule/Webpack/webpack-basics.html#vue脚手架加载配置" class="sidebar-link reco-side-vue脚手架加载配置" data-v-cb1513f6>Vue脚手架加载配置</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----><!----><!----><!----><div class="RibbonAnimation"></div></div></div>
    <script src="/assets/js/app.6b8d69f7.js" defer></script><script src="/assets/js/3.cb90e6dd.js" defer></script><script src="/assets/js/1.e749a552.js" defer></script><script src="/assets/js/32.30328f1c.js" defer></script><script src="/assets/js/9.912710f6.js" defer></script>
  </body>
</html>
